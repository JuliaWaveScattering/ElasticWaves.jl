(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 13.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[    111047,       2874]
NotebookOptionsPosition[    104980,       2774]
NotebookOutlinePosition[    105403,       2791]
CellTagsIndexPosition[    105360,       2788]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell["\<\
when doing a lot of maths, we need someone way to be absolutely sure that no \
mistake has been made . One way is just to reduce things several times, and \
through different routes . I think you must have done that, as I' ve never \
found any mistakes . I personally tend to deduce things on paper, then check \
them in Mathematica. I\[CloseCurlyQuote]ll show you how I do this below.\
\>", "Text",
 CellChangeTimes->{{3.86445196669803*^9, 3.864452091627275*^9}, {
  3.8644521467221603`*^9, 3.8644521711536207`*^9}, {3.864452248345687*^9, 
  3.864452391858406*^9}, {3.8644524326810207`*^9, 
  3.8644525900800858`*^9}},ExpressionUUID->"f31cd68b-6497-479b-9447-\
378ff3fbc61e"],

Cell[BoxData[
 StyleBox[
  RowBox[{"Below", " ", "I", " ", "check", " ", "equation", " ", 
   RowBox[{"(", "29", ")"}], " ", "which", " ", "relates", " ", "the", " ", 
   "potentials", " ", "to", " ", "the", " ", "stress"}], 
  "Subsubsection"]], "Input",
 CellChangeTimes->{{3.86445196669803*^9, 3.864452091627275*^9}, {
  3.8644521467221603`*^9, 3.8644521711536207`*^9}, {3.864452248345687*^9, 
  3.864452391858406*^9}, {3.8644524326810207`*^9, 3.864452616722105*^9}, {
  3.864452752115347*^9, 
  3.864452785208001*^9}},ExpressionUUID->"15c1fbda-52fd-48d7-aca8-\
7ad7a02596e6"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"ClearAll", "[", "subBessel", "]"}], ";"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"the", " ", "stress", " ", "from", " ", "the", " ", "strain"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Sigma]fun", "[", "\[Epsilon]_", "]"}], ":=", " ", 
   RowBox[{
    RowBox[{"\[Lambda]", " ", 
     RowBox[{"Tr", "[", "\[Epsilon]", "]"}], " ", 
     RowBox[{"IdentityMatrix", "[", "3", "]"}]}], " ", "+", " ", 
    RowBox[{"2", " ", "\[Mu]", " ", "\[Epsilon]"}]}]}], "\[IndentingNewLine]",
   "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "the", " ", "stain", " ", "from", " ", "the", " ", "displacement", " ", 
    "vector"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Epsilon]fun", "[", "u_", "]"}], " ", ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"\[Epsilon]1", " ", "=", " ", 
       RowBox[{"Grad", "[", 
        RowBox[{"u", ",", 
         RowBox[{"{", 
          RowBox[{"r", ",", "\[Theta]", ",", "z"}], "}"}], ",", 
         "\"\<Cylindrical\>\""}], "]"}]}], "}"}], ",", "\[IndentingNewLine]", 
     
     RowBox[{"Return", "[", 
      RowBox[{
       RowBox[{"\[Epsilon]1", "/", "2"}], "+", 
       RowBox[{
        RowBox[{"\[Epsilon]1", "\[Transpose]"}], "/", "2"}]}], "]"}]}], 
    "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "the", " ", "displacement", " ", "vector", " ", "from", " ", "the", " ", 
    "potentials"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"ufun", "[", 
    RowBox[{"\[Phi]_", ",", "\[Psi]_"}], "]"}], " ", ":=", " ", 
   RowBox[{
    RowBox[{"Grad", "[", 
     RowBox[{"\[Phi]", ",", 
      RowBox[{"{", 
       RowBox[{"r", ",", "\[Theta]", ",", "z"}], "}"}], ",", 
      "\"\<Cylindrical\>\""}], "]"}], "+", " ", "\[IndentingNewLine]", 
    RowBox[{"Curl", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"0", ",", "0", ",", "\[Psi]"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"r", ",", "\[Theta]", ",", "z"}], "}"}], ",", 
      "\"\<Cylindrical\>\""}], "]"}]}]}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"Some", " ", "quick", " ", "checks"}], "*)"}], 
  "\[IndentingNewLine]", "\n", 
  RowBox[{"(*", " ", 
   RowBox[{"Checked", ":", " ", 
    RowBox[{
    "this", " ", "is", " ", "the", " ", "same", " ", "as", " ", "the", " ", 
     "displacement", " ", "equation", " ", "in", " ", "the", " ", 
     "report"}]}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"ufun", "[", 
    RowBox[{
     RowBox[{"\[Phi]", "[", 
      RowBox[{"r", ",", "\[Theta]"}], "]"}], ",", 
     RowBox[{"\[Psi]", "[", 
      RowBox[{"r", ",", "\[Theta]"}], "]"}]}], "]"}], "//", "MatrixForm"}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{"Checked", ":", " ", 
    RowBox[{
    "this", " ", "is", " ", "the", " ", "same", " ", "as", " ", "the", " ", 
     "strain", " ", "equation", " ", "in", " ", "the", " ", "report"}]}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"\[Epsilon]fun", "[", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"ur", "[", 
        RowBox[{"r", ",", "\[Theta]"}], "]"}], ",", 
       RowBox[{"u\[Theta]", "[", 
        RowBox[{"r", ",", "\[Theta]"}], "]"}], ",", "0"}], "}"}], "]"}], "//",
     "MatrixForm"}], ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{"Checked", ":", " ", 
    RowBox[{
    "this", " ", "is", " ", "the", " ", "same", " ", "as", " ", "the", " ", 
     "first", " ", "equation", " ", "in", " ", "the", " ", "report", " ", 
     "that", " ", "gives", " ", "the", " ", "stress", " ", "in", " ", "terms",
      " ", "of", " ", "the", " ", "displacement"}]}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"\[Sigma]fun", "[", 
     RowBox[{"\[Epsilon]fun", "[", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"ur", "[", 
         RowBox[{"r", ",", "\[Theta]"}], "]"}], ",", 
        RowBox[{"u\[Theta]", "[", 
         RowBox[{"r", ",", "\[Theta]"}], "]"}], ",", "0"}], "}"}], "]"}], 
     "]"}], "[", 
    RowBox[{"[", 
     RowBox[{
      RowBox[{"1", ";;", "2"}], ",", "1"}], "]"}], "]"}], "//", "Simplify"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"\[Sigma]fun", "[", 
     RowBox[{"\[Epsilon]fun", "[", 
      RowBox[{"ufun", "[", 
       RowBox[{
        RowBox[{"\[Phi]", "[", 
         RowBox[{"r", ",", "\[Theta]"}], "]"}], ",", 
        RowBox[{"\[Psi]", "[", 
         RowBox[{"r", ",", "\[Theta]"}], "]"}]}], "]"}], "]"}], "]"}], "[", 
    RowBox[{"[", 
     RowBox[{
      RowBox[{"1", ";;", "2"}], ",", "1"}], "]"}], "]"}], "//", "Simplify"}], 
  ";"}]}], "Input",
 CellChangeTimes->CompressedData["
1:eJwdy2kow3EAxvE1Tc4sNZRarZijlBdaiVZ/YrTVHDWRUjIlsUIsTUq5eWGu
QhKzHKW9kDOb/5qVjWhyxcakmGYtZXLm//xePH16XnwF1aoSJZvFYgmYwVzF
herG5qUWols6oT++rAe2vtT0Q1dU+Cjkqr910GvjrUBNfCxNviHIAadCY86g
OtJ+CTOUejfpt+XLTkZdsmoDNnJ0OzAg6TZCvkZhhu/ly4ew8KrUBburGu5h
Gq31QWlL5RscUMTxXYwWT44QrkWwRfA461IMrff8QSgTmYfgZ2BRfcd4ZBG1
w+E8ah0GUlb3IK+5wAxV3C8r5HMebbDak2mHJR23J3BJ80ScdTp/YKKp5xdq
i0/73Iwd8+IBKB1JGIXsp+BxKKSFczDfcUE0WHp3YZz8ijjfdGCC6edbNPT4
X+1QXFXngLWFY274kV30DJX+SWvFtZcy6g3E64mwZoXHS6V2cdrgPq9+DDp8
m8SXJGe+LuSVEsl7JbB2RPugZzTM7BEfaVnQKuNf1DTxH5rvQmg=
  
  "],ExpressionUUID->"ce7f7aba-66b9-40e6-b7d8-56410ec58cd0"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", 
   TagBox[GridBox[{
      {
       RowBox[{
        FractionBox[
         RowBox[{
          SuperscriptBox["\[Psi]", 
           TagBox[
            RowBox[{"(", 
             RowBox[{"0", ",", "1"}], ")"}],
            Derivative],
           MultilineFunction->None], "[", 
          RowBox[{"r", ",", "\[Theta]"}], "]"}], "r"], "+", 
        RowBox[{
         SuperscriptBox["\[Phi]", 
          TagBox[
           RowBox[{"(", 
            RowBox[{"1", ",", "0"}], ")"}],
           Derivative],
          MultilineFunction->None], "[", 
         RowBox[{"r", ",", "\[Theta]"}], "]"}]}]},
      {
       RowBox[{
        FractionBox[
         RowBox[{
          SuperscriptBox["\[Phi]", 
           TagBox[
            RowBox[{"(", 
             RowBox[{"0", ",", "1"}], ")"}],
            Derivative],
           MultilineFunction->None], "[", 
          RowBox[{"r", ",", "\[Theta]"}], "]"}], "r"], "-", 
        RowBox[{
         SuperscriptBox["\[Psi]", 
          TagBox[
           RowBox[{"(", 
            RowBox[{"1", ",", "0"}], ")"}],
           Derivative],
          MultilineFunction->None], "[", 
         RowBox[{"r", ",", "\[Theta]"}], "]"}]}]},
      {"0"}
     },
     GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
     GridBoxSpacings->{"Columns" -> {
         Offset[0.27999999999999997`], {
          Offset[0.5599999999999999]}, 
         Offset[0.27999999999999997`]}, "Rows" -> {
         Offset[0.2], {
          Offset[0.4]}, 
         Offset[0.2]}}],
    Column], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{
  3.864461294593842*^9, {3.864464483101259*^9, 3.864464496761956*^9}, 
   3.8644645538846397`*^9, 3.864464864943742*^9, {3.864464903887636*^9, 
   3.864464910089003*^9}, {3.864464995602531*^9, 3.864465043711289*^9}, 
   3.864465202910264*^9, 3.86472340558528*^9, 3.8647377173196363`*^9, 
   3.8647906279025908`*^9, 3.864796951586361*^9, 3.8667066497212467`*^9, 
   3.866792404659041*^9, 3.8720527165558167`*^9, 3.872052820289878*^9, 
   3.879929336751338*^9, 3.8804325145872107`*^9, {3.880432562454555*^9, 
   3.880432569246773*^9}, {3.880432798298465*^9, 3.8804328059791927`*^9}, 
   3.896842976507653*^9, 3.896844861217445*^9, 3.896848227250403*^9},
 CellLabel->
  "Out[5]//MatrixForm=",ExpressionUUID->"7bd9dcb8-d1c2-4fdd-bd4f-\
e416e226841f"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   FractionBox[
    RowBox[{
     RowBox[{"\[Lambda]", " ", 
      RowBox[{"ur", "[", 
       RowBox[{"r", ",", "\[Theta]"}], "]"}]}], "+", 
     RowBox[{"\[Lambda]", " ", 
      RowBox[{
       SuperscriptBox["u\[Theta]", 
        TagBox[
         RowBox[{"(", 
          RowBox[{"0", ",", "1"}], ")"}],
         Derivative],
        MultilineFunction->None], "[", 
       RowBox[{"r", ",", "\[Theta]"}], "]"}]}], "+", 
     RowBox[{"r", " ", 
      RowBox[{"(", 
       RowBox[{"\[Lambda]", "+", 
        RowBox[{"2", " ", "\[Mu]"}]}], ")"}], " ", 
      RowBox[{
       SuperscriptBox["ur", 
        TagBox[
         RowBox[{"(", 
          RowBox[{"1", ",", "0"}], ")"}],
         Derivative],
        MultilineFunction->None], "[", 
       RowBox[{"r", ",", "\[Theta]"}], "]"}]}]}], "r"], ",", 
   FractionBox[
    RowBox[{"\[Mu]", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", 
        RowBox[{"u\[Theta]", "[", 
         RowBox[{"r", ",", "\[Theta]"}], "]"}]}], "+", 
       RowBox[{
        SuperscriptBox["ur", 
         TagBox[
          RowBox[{"(", 
           RowBox[{"0", ",", "1"}], ")"}],
          Derivative],
         MultilineFunction->None], "[", 
        RowBox[{"r", ",", "\[Theta]"}], "]"}], "+", 
       RowBox[{"r", " ", 
        RowBox[{
         SuperscriptBox["u\[Theta]", 
          TagBox[
           RowBox[{"(", 
            RowBox[{"1", ",", "0"}], ")"}],
           Derivative],
          MultilineFunction->None], "[", 
         RowBox[{"r", ",", "\[Theta]"}], "]"}]}]}], ")"}]}], "r"]}], 
  "}"}]], "Output",
 CellChangeTimes->{
  3.864461294593842*^9, {3.864464483101259*^9, 3.864464496761956*^9}, 
   3.8644645538846397`*^9, 3.864464864943742*^9, {3.864464903887636*^9, 
   3.864464910089003*^9}, {3.864464995602531*^9, 3.864465043711289*^9}, 
   3.864465202910264*^9, 3.86472340558528*^9, 3.8647377173196363`*^9, 
   3.8647906279025908`*^9, 3.864796951586361*^9, 3.8667066497212467`*^9, 
   3.866792404659041*^9, 3.8720527165558167`*^9, 3.872052820289878*^9, 
   3.879929336751338*^9, 3.8804325145872107`*^9, {3.880432562454555*^9, 
   3.880432569246773*^9}, {3.880432798298465*^9, 3.8804328059791927`*^9}, 
   3.896842976507653*^9, 3.896844861217445*^9, 3.896848227282443*^9},
 CellLabel->"Out[7]=",ExpressionUUID->"2a46dad3-bf39-4863-b71d-d6c78afb7645"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "The", " ", "equation", " ", "relating", " ", "the", " ", "potentials", 
    " ", "to", " ", "the", " ", "stress", " ", "in", " ", "the", " ", 
    "report", " ", "was"}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"\[CapitalSigma]", "[", 
     RowBox[{"\[Phi]_", ",", "\[Psi]_"}], "]"}], ":=", " ", 
    RowBox[{"\[Rho]", " ", 
     RowBox[{"{", " ", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"2", " ", 
            SuperscriptBox["cS", "2"], " ", 
            SuperscriptBox["kP", "2"]}], " ", "-", "  ", 
           SuperscriptBox["\[Omega]", "2"]}], "  ", ")"}], "\[Phi]"}], " ", 
        "+", "  ", 
        RowBox[{"2", " ", 
         SuperscriptBox["cS", "2"], " ", 
         RowBox[{"D", "[", 
          RowBox[{"\[Phi]", ",", 
           RowBox[{"{", 
            RowBox[{"r", ",", "2"}], "}"}]}], "]"}]}], " ", "+", "  ", 
        RowBox[{"2", 
         SuperscriptBox["cS", "2"], " ", 
         RowBox[{"D", "[", 
          RowBox[{
           RowBox[{
            FractionBox["1", "r"], 
            RowBox[{"D", "[", 
             RowBox[{"\[Psi]", ",", "\[Theta]"}], "]"}]}], ",", "r"}], 
          "]"}]}]}], ",", 
       RowBox[{
        RowBox[{"2", 
         SuperscriptBox["cS", "2"], " ", 
         RowBox[{"D", "[", 
          RowBox[{
           RowBox[{
            FractionBox["1", "r"], 
            RowBox[{"D", "[", 
             RowBox[{"\[Phi]", ",", "\[Theta]"}], "]"}]}], ",", "r"}], 
          "]"}]}], " ", "-", " ", 
        RowBox[{
         SuperscriptBox["\[Omega]", "2"], "\[Psi]"}], " ", "-", 
        RowBox[{"2", 
         SuperscriptBox["cS", "2"], 
         RowBox[{"D", "[", 
          RowBox[{"\[Psi]", ",", 
           RowBox[{"{", 
            RowBox[{"r", ",", "2"}], "}"}]}], "]"}]}]}]}], "}"}]}]}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"Note", " ", "the", " ", "simplification", " ", 
     SuperscriptBox["\[Omega]", "2"]}], "->", " ", 
    RowBox[{
     SuperscriptBox["cS", "2"], " ", 
     SuperscriptBox["kS", "2"]}]}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"\[CapitalSigma]", "[", 
     RowBox[{"\[Phi]_", ",", "\[Psi]_"}], "]"}], ":=", " ", 
    RowBox[{"\[Rho]", " ", 
     SuperscriptBox["cS", "2"], 
     RowBox[{"{", " ", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"2", " ", 
            SuperscriptBox["kP", "2"]}], " ", "-", "   ", 
           SuperscriptBox["kS", "2"]}], ")"}], "\[Phi]"}], " ", "+", "  ", 
        RowBox[{"2", "  ", 
         RowBox[{"D", "[", 
          RowBox[{"\[Phi]", ",", 
           RowBox[{"{", 
            RowBox[{"r", ",", "2"}], "}"}]}], "]"}]}], " ", "+", "  ", 
        RowBox[{"2", " ", 
         RowBox[{"D", "[", 
          RowBox[{
           RowBox[{
            FractionBox["1", "r"], 
            RowBox[{"D", "[", 
             RowBox[{"\[Psi]", ",", "\[Theta]"}], "]"}]}], ",", "r"}], 
          "]"}]}]}], ",", 
       RowBox[{
        RowBox[{"2", " ", 
         RowBox[{"D", "[", 
          RowBox[{
           RowBox[{
            FractionBox["1", "r"], 
            RowBox[{"D", "[", 
             RowBox[{"\[Phi]", ",", "\[Theta]"}], "]"}]}], ",", "r"}], 
          "]"}]}], " ", "-", "  ", 
        RowBox[{
         SuperscriptBox["kS", "2"], "\[Psi]"}], " ", "-", 
        RowBox[{"2", 
         RowBox[{"D", "[", 
          RowBox[{"\[Psi]", ",", 
           RowBox[{"{", 
            RowBox[{"r", ",", "2"}], "}"}]}], "]"}]}]}]}], "}"}]}]}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"Let", "'"}], "s", " ", "check", " ", "if", " ", "they", " ", 
     "are", " ", "the", " ", "same"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"$Assumptions", "=", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"r2", ">", "0"}], ",", 
       RowBox[{"r1", ">", "0"}], ",", 
       RowBox[{"r", ">", "0"}], ",", 
       RowBox[{"0", "<", "\[Theta]", "<", 
        RowBox[{"2", "\[Pi]"}]}]}], "}"}]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"subBessel", "[", "m_", "]"}], " ", "=", " ", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"BesselJ", "[", 
        RowBox[{"m", ",", "kr_"}], "]"}], " ", ":>", " ", 
       RowBox[{
        FractionBox["kr", 
         RowBox[{"2", " ", "m"}]], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"BesselJ", "[", 
           RowBox[{
            RowBox[{"m", "-", "1"}], ",", "kr"}], "]"}], " ", "+", " ", 
          RowBox[{"BesselJ", "[", 
           RowBox[{
            RowBox[{"m", "+", "1"}], ",", "kr"}], "]"}]}], " ", ")"}]}]}], 
      " ", "}"}]}], ";"}], "\n", "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"N\[Phi]", "=", " ", 
     RowBox[{
      RowBox[{
       RowBox[{"BesselJ", "[", 
        RowBox[{"n", ",", " ", 
         RowBox[{"r", " ", "kP"}]}], "]"}], " ", 
       SuperscriptBox["\[ExponentialE]", 
        RowBox[{"\[ImaginaryI]", " ", "n", " ", "\[Theta]"}]]}], "/.", 
      RowBox[{"n", "->", 
       RowBox[{"-", "4"}]}]}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"N\[Psi]", "=", " ", 
     RowBox[{
      RowBox[{
       RowBox[{"BesselJ", "[", 
        RowBox[{"n", ",", " ", 
         RowBox[{"r", " ", "kS"}]}], "]"}], " ", 
       SuperscriptBox["\[ExponentialE]", 
        RowBox[{"\[ImaginaryI]", " ", "n", " ", "\[Theta]"}]]}], "/.", 
      RowBox[{"n", "->", "1"}]}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"\[Sigma]2", " ", "=", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{"\[Sigma]fun", "@", 
         RowBox[{"\[Epsilon]fun", "@", 
          RowBox[{"ufun", "[", 
           RowBox[{"N\[Phi]", " ", ",", "N\[Psi]"}], "]"}]}]}], ")"}], "[", 
       RowBox[{"[", "1", "]"}], "]"}], "[", 
      RowBox[{"[", 
       RowBox[{"1", ";;", "2"}], "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"\[Sigma]2", "-", 
       RowBox[{"\[CapitalSigma]", "[", 
        RowBox[{"N\[Phi]", ",", "N\[Psi]"}], "]"}]}], "//.", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"\[Mu]", " ", "->", " ", 
         RowBox[{"\[Rho]", " ", 
          SuperscriptBox["cS", "2"]}]}], ",", 
        RowBox[{"\[Lambda]", " ", "->", " ", 
         RowBox[{
          RowBox[{"\[Rho]", " ", 
           SuperscriptBox["cP", "2"]}], "-", 
          RowBox[{"2", " ", "\[Mu]"}]}]}]}], "}"}]}], "/.", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"cS", " ", "->", " ", 
        RowBox[{"\[Omega]", "/", "kS"}]}], ",", 
       RowBox[{"cP", " ", "->", " ", 
        RowBox[{"\[Omega]", "/", "kP"}]}]}], "}"}]}], " ", "//", 
    "FullSimplify"}], "\[IndentingNewLine]"}]}]], "Input",
 CellChangeTimes->CompressedData["
1:eJwd0Gkow3EYB/CFaULkzhhTFpsjZxLFRstRMm3myhyjhCXL0eQoW4gU77zw
ZrOa5Hijthdq4w2TZBqGOfJiGMn1xsTv+3/x9On71PPi+7BbFSK5F41GiycD
BRK74vLAXawNUY7BN2atBg48tU9DZ5D/Igwe+tFB90H4KhxhRpqpvOl9Apf8
ImxwKNB6BrPl+jvq3lhluCbqkhTbsJeuM8FvoXoHskYkFvhVZ9iHZec1Tqhu
7rmFqeaFV1ihbHyHM5IolpO498jnwPUAr1yobGEWUHtLbRHs0m5JYO+zqh5y
v1fbIL9K1gUzEo3dsIA1rIRZ/AYNnJx3XEHLlPgeskM70m6ID7y0TMiN9qmG
DPYapZETJ4Xt7o5ByPq1q6Ds1EGZ/7ESdkss5dXEws8mQwLM0Wsy4UbRrgjm
lfeLocuV7Wm2kl4mEaVG7psuI6ZI+yh9j+jMTqLU9RcD9XLn8ThxtlBwCe02
wUX9Bfn3zagDTiUva7WMl+KSBD1l5ZxnQkdkHArV8B/rJShI
  "],
 CellLabel->"In[9]:=",ExpressionUUID->"0e7409ac-b54a-489c-9b37-50416ead2a46"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"0", ",", "0"}], "}"}]], "Output",
 CellChangeTimes->{{3.8644582404653254`*^9, 3.864458291683958*^9}, 
   3.86445887489571*^9, {3.8644589854190207`*^9, 3.864459027747757*^9}, 
   3.864459858127551*^9, 3.864459913061282*^9, {3.8644599716284437`*^9, 
   3.864460002721118*^9}, 3.864460200561523*^9, {3.8644602496011667`*^9, 
   3.864460297585122*^9}, {3.864461335053626*^9, 3.8644613434916553`*^9}, {
   3.864461490436306*^9, 3.8644615564771347`*^9}, {3.864461590670854*^9, 
   3.8644617165643797`*^9}, {3.864461975978836*^9, 3.864461995924265*^9}, 
   3.864723414593343*^9, 3.864723835945257*^9, 3.8647377200982847`*^9, 
   3.864738047246413*^9, 3.8647452688977127`*^9, 3.864790629789281*^9, {
   3.864790731969534*^9, 3.8647907468193197`*^9}, 3.864796954014514*^9, 
   3.8667066512402687`*^9, 3.86679240663299*^9, 3.8720527227228947`*^9, 
   3.87205287962954*^9, {3.872052939147607*^9, 3.872052948774603*^9}, 
   3.879929338463565*^9, {3.880432646334464*^9, 3.88043264738335*^9}, 
   3.896842978150242*^9, 3.896844873590104*^9, 3.896845355201475*^9, 
   3.8968482284393063`*^9},
 CellLabel->"Out[15]=",ExpressionUUID->"36b8d6d9-8810-4cdb-8416-9a0cbc23a506"]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
Extract the stress and displacement on some boundary for one mode\
\>", "Subsection",
 CellChangeTimes->{{3.87205453144171*^9, 
  3.872054554880209*^9}},ExpressionUUID->"1ebfa159-742b-4f31-8848-\
2d86db2e38d0"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"ClearAll", "[", "n", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"submodes", " ", "=", " ", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"\[Phi]", " ", "->", " ", 
      RowBox[{
       RowBox[{
        RowBox[{"a", "[", "n", "]"}], 
        RowBox[{"BesselJ", "[", 
         RowBox[{"n", ",", 
          RowBox[{"kP", " ", "r"}]}], "]"}], " ", 
        SuperscriptBox["\[ExponentialE]", 
         RowBox[{"\[ImaginaryI]", " ", "n", " ", "\[Theta]"}]]}], " ", "+", 
       " ", 
       RowBox[{
        RowBox[{"b", "[", "n", "]"}], 
        RowBox[{"HankelH1", "[", 
         RowBox[{"n", ",", 
          RowBox[{"kP", " ", "r"}]}], "]"}], " ", 
        SuperscriptBox["\[ExponentialE]", 
         RowBox[{"\[ImaginaryI]", " ", "n", " ", "\[Theta]"}]]}]}]}], ",", 
     RowBox[{"\[Psi]", " ", "->", " ", 
      RowBox[{
       RowBox[{
        RowBox[{"c", "[", "n", "]"}], 
        RowBox[{"BesselJ", "[", 
         RowBox[{"n", ",", 
          RowBox[{"kS", " ", "r"}]}], "]"}], " ", 
        SuperscriptBox["\[ExponentialE]", 
         RowBox[{"\[ImaginaryI]", " ", "n", " ", "\[Theta]"}]]}], " ", "+", 
       " ", 
       RowBox[{
        RowBox[{"d", "[", "n", "]"}], 
        RowBox[{"HankelH1", "[", 
         RowBox[{"n", ",", 
          RowBox[{"kS", " ", "r"}]}], "]"}], " ", 
        SuperscriptBox["\[ExponentialE]", 
         RowBox[{"\[ImaginaryI]", " ", "n", " ", "\[Theta]"}]]}]}]}]}], 
    "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{" ", 
  RowBox[{
   RowBox[{"\[CapitalSigma]modes", "=", " ", 
    RowBox[{"\[CapitalSigma]", "[", 
     RowBox[{
      RowBox[{"\[Phi]", "/.", "submodes"}], ",", 
      RowBox[{"\[Psi]", "/.", "submodes"}]}], "]"}]}], 
   ";"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"umodes", "=", " ", 
    RowBox[{
     RowBox[{"ufun", "[", 
      RowBox[{
       RowBox[{"\[Phi]", "/.", "submodes"}], ",", 
       RowBox[{"\[Psi]", "/.", "submodes"}]}], "]"}], "[", 
     RowBox[{"[", 
      RowBox[{"1", ";;", "2"}], "]"}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"coes", " ", "=", " ", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"a", "[", "n", "]"}], ",", 
     RowBox[{"b", "[", "n", "]"}], ",", 
     RowBox[{"c", "[", "n", "]"}], ",", 
     RowBox[{"d", "[", "n", "]"}]}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[CapitalSigma]n", " ", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"Coefficient", "[", 
      RowBox[{"\[CapitalSigma]modes", ",", "#"}], "]"}], "&"}], "/@", 
    "coes"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[CapitalSigma]n", " ", "=", " ", 
    RowBox[{
     RowBox[{"\[CapitalSigma]n", "\[Transpose]"}], " ", "//", "Simplify"}]}], 
   ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"un", " ", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"Coefficient", "[", 
      RowBox[{"umodes", ",", "#"}], "]"}], "&"}], "/@", "coes"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"un", " ", "=", " ", 
    RowBox[{
     RowBox[{"un", "\[Transpose]"}], " ", "//", "Simplify"}]}], ";"}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"A", " ", "quick", " ", "check"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[CapitalSigma]n", ".", "coes"}], " ", "==", " ", 
   "\[CapitalSigma]modes"}], "//", "Simplify"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"un", ".", "coes"}], " ", "==", " ", "umodes"}], "//", 
   "Simplify"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"Pressure", " ", "potential", " ", "modes"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[CapitalSigma]n", "[", 
    RowBox[{"[", 
     RowBox[{"All", ",", "1"}], "]"}], "]"}], " ", "//", "MatrixForm"}], "//",
   "Simplify"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"un", "[", 
     RowBox[{"[", 
      RowBox[{"All", ",", "1"}], "]"}], "]"}], "  ", "//", "MatrixForm"}], "//",
    "Simplify"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"Shear", " ", "potential", " ", "modes"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[CapitalSigma]n", "[", 
    RowBox[{"[", 
     RowBox[{"All", ",", "3"}], "]"}], "]"}], " ", "//", "MatrixForm"}], "//",
   "Simplify"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"un", "[", 
    RowBox[{"[", 
     RowBox[{"All", ",", "3"}], "]"}], "]"}], "  ", "//", "MatrixForm"}], "//",
   "Simplify"}]}], "Input",
 CellChangeTimes->{{3.87205453144171*^9, 3.872054651847602*^9}, {
  3.872054783525581*^9, 3.872054785920328*^9}, {3.879929371729764*^9, 
  3.879929399304173*^9}, {3.8804329324893103`*^9, 3.880432952217491*^9}, {
  3.880432992336094*^9, 3.8804330155388727`*^9}, {3.880433088952991*^9, 
  3.8804330891682987`*^9}, {3.880433138266307*^9, 3.880433139617193*^9}, {
  3.8804331875129747`*^9, 3.88043330427264*^9}},
 CellLabel->"In[16]:=",ExpressionUUID->"ac31c522-5dee-4b23-a408-4436b8aa72b1"],

Cell[BoxData["True"], "Output",
 CellChangeTimes->{
  3.872054653167951*^9, 3.872054791327619*^9, 3.879929341148752*^9, {
   3.879929372040574*^9, 3.87992939973944*^9}, 3.880432865538928*^9, {
   3.880432933233583*^9, 3.880432954526641*^9}, {3.880432994813285*^9, 
   3.88043301586727*^9}, 3.880433089801806*^9, 3.880433139922538*^9, {
   3.8804331887228613`*^9, 3.8804332379344797`*^9}, 3.880433272510385*^9, 
   3.880433304862468*^9, 3.896842982657652*^9, 3.896848229241454*^9},
 CellLabel->"Out[25]=",ExpressionUUID->"5cc1dc10-c401-426b-b3ee-dcaf4f1bc399"],

Cell[BoxData["True"], "Output",
 CellChangeTimes->{
  3.872054653167951*^9, 3.872054791327619*^9, 3.879929341148752*^9, {
   3.879929372040574*^9, 3.87992939973944*^9}, 3.880432865538928*^9, {
   3.880432933233583*^9, 3.880432954526641*^9}, {3.880432994813285*^9, 
   3.88043301586727*^9}, 3.880433089801806*^9, 3.880433139922538*^9, {
   3.8804331887228613`*^9, 3.8804332379344797`*^9}, 3.880433272510385*^9, 
   3.880433304862468*^9, 3.896842982657652*^9, 3.896848229305236*^9},
 CellLabel->"Out[26]=",ExpressionUUID->"6fb2d1e7-8f10-48b0-b5d0-e23254e2b329"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", 
   TagBox[GridBox[{
      {
       RowBox[{"-", 
        FractionBox[
         RowBox[{
          SuperscriptBox["cS", "2"], " ", 
          SuperscriptBox["\[ExponentialE]", 
           RowBox[{"\[ImaginaryI]", " ", "n", " ", "\[Theta]"}]], " ", 
          "\[Rho]", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"2", " ", "kP", " ", "r", " ", 
             RowBox[{"BesselJ", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"-", "1"}], "+", "n"}], ",", 
               RowBox[{"kP", " ", "r"}]}], "]"}]}], "+", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{
                RowBox[{"-", "2"}], " ", "n"}], "-", 
               RowBox[{"2", " ", 
                SuperscriptBox["n", "2"]}], "+", 
               RowBox[{
                SuperscriptBox["kS", "2"], " ", 
                SuperscriptBox["r", "2"]}]}], ")"}], " ", 
             RowBox[{"BesselJ", "[", 
              RowBox[{"n", ",", 
               RowBox[{"kP", " ", "r"}]}], "]"}]}]}], ")"}]}], 
         SuperscriptBox["r", "2"]]}]},
      {
       FractionBox[
        RowBox[{"\[ImaginaryI]", " ", 
         SuperscriptBox["cS", "2"], " ", 
         SuperscriptBox["\[ExponentialE]", 
          RowBox[{"\[ImaginaryI]", " ", "n", " ", "\[Theta]"}]], " ", "n", 
         " ", "\[Rho]", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"kP", " ", "r", " ", 
            RowBox[{"BesselJ", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"-", "1"}], "+", "n"}], ",", 
              RowBox[{"kP", " ", "r"}]}], "]"}]}], "-", 
           RowBox[{"2", " ", 
            RowBox[{"BesselJ", "[", 
             RowBox[{"n", ",", 
              RowBox[{"kP", " ", "r"}]}], "]"}]}], "-", 
           RowBox[{"kP", " ", "r", " ", 
            RowBox[{"BesselJ", "[", 
             RowBox[{
              RowBox[{"1", "+", "n"}], ",", 
              RowBox[{"kP", " ", "r"}]}], "]"}]}]}], ")"}]}], 
        SuperscriptBox["r", "2"]]}
     },
     GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
     GridBoxSpacings->{"Columns" -> {
         Offset[0.27999999999999997`], {
          Offset[0.5599999999999999]}, 
         Offset[0.27999999999999997`]}, "Rows" -> {
         Offset[0.2], {
          Offset[0.4]}, 
         Offset[0.2]}}],
    Column], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{
  3.872054653167951*^9, 3.872054791327619*^9, 3.879929341148752*^9, {
   3.879929372040574*^9, 3.87992939973944*^9}, 3.880432865538928*^9, {
   3.880432933233583*^9, 3.880432954526641*^9}, {3.880432994813285*^9, 
   3.88043301586727*^9}, 3.880433089801806*^9, 3.880433139922538*^9, {
   3.8804331887228613`*^9, 3.8804332379344797`*^9}, 3.880433272510385*^9, 
   3.880433304862468*^9, 3.896842982657652*^9, 3.89684822932043*^9},
 CellLabel->
  "Out[27]//MatrixForm=",ExpressionUUID->"049649b8-8b0b-499a-8354-\
85657f9cb8f5"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", 
   TagBox[GridBox[{
      {
       RowBox[{
        FractionBox["1", "2"], " ", 
        SuperscriptBox["\[ExponentialE]", 
         RowBox[{"\[ImaginaryI]", " ", "n", " ", "\[Theta]"}]], " ", "kP", 
        " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"BesselJ", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"-", "1"}], "+", "n"}], ",", 
            RowBox[{"kP", " ", "r"}]}], "]"}], "-", 
          RowBox[{"BesselJ", "[", 
           RowBox[{
            RowBox[{"1", "+", "n"}], ",", 
            RowBox[{"kP", " ", "r"}]}], "]"}]}], ")"}]}]},
      {
       FractionBox[
        RowBox[{"\[ImaginaryI]", " ", 
         SuperscriptBox["\[ExponentialE]", 
          RowBox[{"\[ImaginaryI]", " ", "n", " ", "\[Theta]"}]], " ", "n", 
         " ", 
         RowBox[{"BesselJ", "[", 
          RowBox[{"n", ",", 
           RowBox[{"kP", " ", "r"}]}], "]"}]}], "r"]}
     },
     GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
     GridBoxSpacings->{"Columns" -> {
         Offset[0.27999999999999997`], {
          Offset[0.5599999999999999]}, 
         Offset[0.27999999999999997`]}, "Rows" -> {
         Offset[0.2], {
          Offset[0.4]}, 
         Offset[0.2]}}],
    Column], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{
  3.872054653167951*^9, 3.872054791327619*^9, 3.879929341148752*^9, {
   3.879929372040574*^9, 3.87992939973944*^9}, 3.880432865538928*^9, {
   3.880432933233583*^9, 3.880432954526641*^9}, {3.880432994813285*^9, 
   3.88043301586727*^9}, 3.880433089801806*^9, 3.880433139922538*^9, {
   3.8804331887228613`*^9, 3.8804332379344797`*^9}, 3.880433272510385*^9, 
   3.880433304862468*^9, 3.896842982657652*^9, 3.8968482293229027`*^9},
 CellLabel->
  "Out[28]//MatrixForm=",ExpressionUUID->"d81d9611-d1b3-4c42-b028-\
0716fec7655b"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", 
   TagBox[GridBox[{
      {
       FractionBox[
        RowBox[{"\[ImaginaryI]", " ", 
         SuperscriptBox["cS", "2"], " ", 
         SuperscriptBox["\[ExponentialE]", 
          RowBox[{"\[ImaginaryI]", " ", "n", " ", "\[Theta]"}]], " ", "n", 
         " ", "\[Rho]", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"kS", " ", "r", " ", 
            RowBox[{"BesselJ", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"-", "1"}], "+", "n"}], ",", 
              RowBox[{"kS", " ", "r"}]}], "]"}]}], "-", 
           RowBox[{"2", " ", 
            RowBox[{"BesselJ", "[", 
             RowBox[{"n", ",", 
              RowBox[{"kS", " ", "r"}]}], "]"}]}], "-", 
           RowBox[{"kS", " ", "r", " ", 
            RowBox[{"BesselJ", "[", 
             RowBox[{
              RowBox[{"1", "+", "n"}], ",", 
              RowBox[{"kS", " ", "r"}]}], "]"}]}]}], ")"}]}], 
        SuperscriptBox["r", "2"]]},
      {
       FractionBox[
        RowBox[{
         SuperscriptBox["cS", "2"], " ", 
         SuperscriptBox["\[ExponentialE]", 
          RowBox[{"\[ImaginaryI]", " ", "n", " ", "\[Theta]"}]], " ", 
         "\[Rho]", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"2", " ", "kS", " ", "r", " ", 
            RowBox[{"BesselJ", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"-", "1"}], "+", "n"}], ",", 
              RowBox[{"kS", " ", "r"}]}], "]"}]}], "+", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{"-", "2"}], " ", "n"}], "-", 
              RowBox[{"2", " ", 
               SuperscriptBox["n", "2"]}], "+", 
              RowBox[{
               SuperscriptBox["kS", "2"], " ", 
               SuperscriptBox["r", "2"]}]}], ")"}], " ", 
            RowBox[{"BesselJ", "[", 
             RowBox[{"n", ",", 
              RowBox[{"kS", " ", "r"}]}], "]"}]}]}], ")"}]}], 
        SuperscriptBox["r", "2"]]}
     },
     GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
     GridBoxSpacings->{"Columns" -> {
         Offset[0.27999999999999997`], {
          Offset[0.5599999999999999]}, 
         Offset[0.27999999999999997`]}, "Rows" -> {
         Offset[0.2], {
          Offset[0.4]}, 
         Offset[0.2]}}],
    Column], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{
  3.872054653167951*^9, 3.872054791327619*^9, 3.879929341148752*^9, {
   3.879929372040574*^9, 3.87992939973944*^9}, 3.880432865538928*^9, {
   3.880432933233583*^9, 3.880432954526641*^9}, {3.880432994813285*^9, 
   3.88043301586727*^9}, 3.880433089801806*^9, 3.880433139922538*^9, {
   3.8804331887228613`*^9, 3.8804332379344797`*^9}, 3.880433272510385*^9, 
   3.880433304862468*^9, 3.896842982657652*^9, 3.896848229325*^9},
 CellLabel->
  "Out[29]//MatrixForm=",ExpressionUUID->"7d71cda3-b35f-4c8f-a2b9-\
b2de3e08edc9"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", 
   TagBox[GridBox[{
      {
       FractionBox[
        RowBox[{"\[ImaginaryI]", " ", 
         SuperscriptBox["\[ExponentialE]", 
          RowBox[{"\[ImaginaryI]", " ", "n", " ", "\[Theta]"}]], " ", "n", 
         " ", 
         RowBox[{"BesselJ", "[", 
          RowBox[{"n", ",", 
           RowBox[{"kS", " ", "r"}]}], "]"}]}], "r"]},
      {
       RowBox[{
        RowBox[{"-", 
         FractionBox["1", "2"]}], " ", 
        SuperscriptBox["\[ExponentialE]", 
         RowBox[{"\[ImaginaryI]", " ", "n", " ", "\[Theta]"}]], " ", "kS", 
        " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"BesselJ", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"-", "1"}], "+", "n"}], ",", 
            RowBox[{"kS", " ", "r"}]}], "]"}], "-", 
          RowBox[{"BesselJ", "[", 
           RowBox[{
            RowBox[{"1", "+", "n"}], ",", 
            RowBox[{"kS", " ", "r"}]}], "]"}]}], ")"}]}]}
     },
     GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
     GridBoxSpacings->{"Columns" -> {
         Offset[0.27999999999999997`], {
          Offset[0.5599999999999999]}, 
         Offset[0.27999999999999997`]}, "Rows" -> {
         Offset[0.2], {
          Offset[0.4]}, 
         Offset[0.2]}}],
    Column], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{
  3.872054653167951*^9, 3.872054791327619*^9, 3.879929341148752*^9, {
   3.879929372040574*^9, 3.87992939973944*^9}, 3.880432865538928*^9, {
   3.880432933233583*^9, 3.880432954526641*^9}, {3.880432994813285*^9, 
   3.88043301586727*^9}, 3.880433089801806*^9, 3.880433139922538*^9, {
   3.8804331887228613`*^9, 3.8804332379344797`*^9}, 3.880433272510385*^9, 
   3.880433304862468*^9, 3.896842982657652*^9, 3.896848229327381*^9},
 CellLabel->
  "Out[30]//MatrixForm=",ExpressionUUID->"74b44ed6-9ed5-48be-aff7-\
3928a0fb04ce"]
}, Open  ]],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"\[CapitalSigma]n2", " ", "=", " ", 
    RowBox[{
     RowBox[{
      RowBox[{"\[CapitalSigma]n", "/", 
       SuperscriptBox["\[ExponentialE]", 
        RowBox[{"\[ImaginaryI]", " ", "n", " ", "\[Theta]"}]]}], " ", "/.", 
      RowBox[{"{", " ", 
       RowBox[{
        RowBox[{"\[Rho]", " ", "->", " ", 
         FractionBox[
          RowBox[{
           SuperscriptBox["r", "2"], " ", "\[Rho]S"}], 
          SuperscriptBox["cS", "2"]]}], ",", " ", 
        RowBox[{
         RowBox[{"BesselJ", "[", 
          RowBox[{"n_", ",", "a_"}], "]"}], ":>", " ", 
         RowBox[{
          SubscriptBox["J", "n"], "[", "a", "]"}]}], ",", " ", 
        RowBox[{
         RowBox[{"HankelH1", "[", 
          RowBox[{"n_", ",", "a_"}], "]"}], ":>", " ", 
         RowBox[{
          SubscriptBox["H", "n"], "[", "a", "]"}]}]}], "}"}]}], " ", "//", 
     "Simplify"}]}], ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"un2", " ", "=", " ", 
   RowBox[{
    RowBox[{
     RowBox[{"un", "/", 
      SuperscriptBox["\[ExponentialE]", 
       RowBox[{"\[ImaginaryI]", " ", "n", " ", "\[Theta]"}]]}], " ", "/.", 
     RowBox[{"{", "  ", 
      RowBox[{
       RowBox[{
        RowBox[{"BesselJ", "[", 
         RowBox[{"n_", ",", "a_"}], "]"}], ":>", " ", 
        RowBox[{
         SubscriptBox["J", "n"], "[", "a", "]"}]}], ",", " ", 
       RowBox[{
        RowBox[{"HankelH1", "[", 
         RowBox[{"n_", ",", "a_"}], "]"}], ":>", " ", 
        RowBox[{
         SubscriptBox["H", "n"], "[", "a", "]"}]}]}], "}"}]}], " ", "//", 
    "Simplify"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.87205453144171*^9, 3.872054683508149*^9}, {
  3.872054723747924*^9, 3.872054760592606*^9}, {3.872054804254156*^9, 
  3.872054808464551*^9}},
 CellLabel->
  "In[145]:=",ExpressionUUID->"d7be7fae-e9d6-4287-b40c-f2849ad0ba97"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
   "Extract", " ", "only", " ", "the", " ", "1", "st", " ", "and", " ", "3", 
    "rd", " ", "column", " ", "of", " ", "the", " ", "stress", " ", "mode"}], 
   "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"Vs", " ", "=", 
     RowBox[{
      RowBox[{"Transpose", "[", "\[CapitalSigma]n2", "]"}], "[", 
      RowBox[{"[", 
       RowBox[{"{", 
        RowBox[{"1", ",", "3"}], "}"}], "]"}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{
     "A", " ", "quick", " ", "check", " ", "that", " ", "swapping", " ", "J", 
      " ", "for", " ", "H", " ", "turns", " ", "the", " ", "1", "st", " ", 
      "column", " ", "into", " ", "2", "nd"}], ",", " ", 
     RowBox[{
     "and", " ", "the", " ", "3", "rd", " ", "column", " ", "into", " ", 
      "the", " ", "4", "th"}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"Transpose", "[", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"Vs", "[", 
         RowBox[{"[", "1", "]"}], "]"}], ",", 
        RowBox[{
         RowBox[{"Vs", "[", 
          RowBox[{"[", "1", "]"}], "]"}], "/.", 
         RowBox[{"J", "->", "H"}]}], ",", 
        RowBox[{"Vs", "[", 
         RowBox[{"[", "2", "]"}], "]"}], ",", 
        RowBox[{
         RowBox[{"Vs", "[", 
          RowBox[{"[", "2", "]"}], "]"}], "/.", 
         RowBox[{"J", "->", "H"}]}]}], "}"}], "]"}], " ", "==", " ", 
     "\[CapitalSigma]n2"}], " ", "//", "Simplify"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Vs", "[", 
     RowBox[{"[", "1", "]"}], "]"}], "/.", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{
       SubscriptBox["J", "n_"], "[", "a_", "]"}], " ", ":>", " ", 
      RowBox[{"J", "[", 
       RowBox[{"n", ",", "a"}], "]"}]}], "}"}]}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Vs", "[", 
     RowBox[{"[", "2", "]"}], "]"}], "/.", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{
       SubscriptBox["J", "n_"], "[", "a_", "]"}], " ", ":>", " ", 
      RowBox[{"J", "[", 
       RowBox[{"n", ",", "a"}], "]"}]}], "}"}]}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "Extract", " ", "only", " ", "the", " ", "1", "st", " ", "and", " ", "3", 
     "rd", " ", "column", " ", "of", " ", "the", " ", "displacement", " ", 
     "mode"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Vs", " ", "=", 
     RowBox[{
      RowBox[{"Transpose", "[", "un2", "]"}], "[", 
      RowBox[{"[", 
       RowBox[{"{", 
        RowBox[{"1", ",", "3"}], "}"}], "]"}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{
     "A", " ", "quick", " ", "check", " ", "that", " ", "swapping", " ", "J", 
      " ", "for", " ", "H", " ", "turns", " ", "the", " ", "1", "st", " ", 
      "column", " ", "into", " ", "2", "nd"}], ",", " ", 
     RowBox[{
     "and", " ", "the", " ", "3", "rd", " ", "column", " ", "into", " ", 
      "the", " ", "4", "th"}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"Transpose", "[", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"Vs", "[", 
         RowBox[{"[", "1", "]"}], "]"}], ",", 
        RowBox[{
         RowBox[{"Vs", "[", 
          RowBox[{"[", "1", "]"}], "]"}], "/.", 
         RowBox[{"J", "->", "H"}]}], ",", 
        RowBox[{"Vs", "[", 
         RowBox[{"[", "2", "]"}], "]"}], ",", 
        RowBox[{
         RowBox[{"Vs", "[", 
          RowBox[{"[", "2", "]"}], "]"}], "/.", 
         RowBox[{"J", "->", "H"}]}]}], "}"}], "]"}], " ", "==", " ", "un2"}], 
    " ", "//", "Simplify"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Vs", "[", 
     RowBox[{"[", "1", "]"}], "]"}], "/.", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{
       SubscriptBox["J", "n_"], "[", "a_", "]"}], " ", ":>", " ", 
      RowBox[{"J", "[", 
       RowBox[{"n", ",", "a"}], "]"}]}], "}"}]}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Vs", "[", 
     RowBox[{"[", "2", "]"}], "]"}], "/.", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{
       SubscriptBox["J", "n_"], "[", "a_", "]"}], " ", ":>", " ", 
      RowBox[{"J", "[", 
       RowBox[{"n", ",", "a"}], "]"}]}], "}"}]}], 
   "\[IndentingNewLine]"}]}]], "Input",
 CellChangeTimes->{{3.87205453144171*^9, 3.872054672411179*^9}, {
   3.872054731826984*^9, 3.872054736395814*^9}, {3.872054822714408*^9, 
   3.872054840330494*^9}, 3.8720548752475557`*^9},
 CellLabel->
  "In[147]:=",ExpressionUUID->"b1185457-102d-43d7-9ae5-f802715e4896"],

Cell[BoxData["True"], "Output",
 CellChangeTimes->{3.8720548767503767`*^9},
 CellLabel->
  "Out[148]=",ExpressionUUID->"59cf3834-3a0f-401e-acd0-41d1516174ba"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{
    RowBox[{"-", "\[Rho]S"}], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"2", " ", "kP", " ", "r", " ", 
       RowBox[{"J", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "1"}], "+", "n"}], ",", 
         RowBox[{"kP", " ", "r"}]}], "]"}]}], "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "2"}], " ", "n"}], "-", 
         RowBox[{"2", " ", 
          SuperscriptBox["n", "2"]}], "+", 
         RowBox[{
          SuperscriptBox["kS", "2"], " ", 
          SuperscriptBox["r", "2"]}]}], ")"}], " ", 
       RowBox[{"J", "[", 
        RowBox[{"n", ",", 
         RowBox[{"kP", " ", "r"}]}], "]"}]}]}], ")"}]}], ",", 
   RowBox[{"\[ImaginaryI]", " ", "n", " ", "\[Rho]S", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"kP", " ", "r", " ", 
       RowBox[{"J", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "1"}], "+", "n"}], ",", 
         RowBox[{"kP", " ", "r"}]}], "]"}]}], "-", 
      RowBox[{"2", " ", 
       RowBox[{"J", "[", 
        RowBox[{"n", ",", 
         RowBox[{"kP", " ", "r"}]}], "]"}]}], "-", 
      RowBox[{"kP", " ", "r", " ", 
       RowBox[{"J", "[", 
        RowBox[{
         RowBox[{"1", "+", "n"}], ",", 
         RowBox[{"kP", " ", "r"}]}], "]"}]}]}], ")"}]}]}], "}"}]], "Output",
 CellChangeTimes->{3.872054876760724*^9},
 CellLabel->
  "Out[149]=",ExpressionUUID->"da2b4b9e-89a3-4ea1-9506-b72028ff6e4b"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"\[ImaginaryI]", " ", "n", " ", "\[Rho]S", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"kS", " ", "r", " ", 
       RowBox[{"J", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "1"}], "+", "n"}], ",", 
         RowBox[{"kS", " ", "r"}]}], "]"}]}], "-", 
      RowBox[{"2", " ", 
       RowBox[{"J", "[", 
        RowBox[{"n", ",", 
         RowBox[{"kS", " ", "r"}]}], "]"}]}], "-", 
      RowBox[{"kS", " ", "r", " ", 
       RowBox[{"J", "[", 
        RowBox[{
         RowBox[{"1", "+", "n"}], ",", 
         RowBox[{"kS", " ", "r"}]}], "]"}]}]}], ")"}]}], ",", 
   RowBox[{"\[Rho]S", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"2", " ", "kS", " ", "r", " ", 
       RowBox[{"J", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "1"}], "+", "n"}], ",", 
         RowBox[{"kS", " ", "r"}]}], "]"}]}], "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "2"}], " ", "n"}], "-", 
         RowBox[{"2", " ", 
          SuperscriptBox["n", "2"]}], "+", 
         RowBox[{
          SuperscriptBox["kS", "2"], " ", 
          SuperscriptBox["r", "2"]}]}], ")"}], " ", 
       RowBox[{"J", "[", 
        RowBox[{"n", ",", 
         RowBox[{"kS", " ", "r"}]}], "]"}]}]}], ")"}]}]}], "}"}]], "Output",
 CellChangeTimes->{3.8720548767699966`*^9},
 CellLabel->
  "Out[150]=",ExpressionUUID->"4576805d-581e-4ccd-88ba-f840a9162dad"],

Cell[BoxData["True"], "Output",
 CellChangeTimes->{3.8720548767785892`*^9},
 CellLabel->
  "Out[152]=",ExpressionUUID->"cd7263f0-af74-4666-a7ce-fbecde7a2fc8"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{
    FractionBox["1", "2"], " ", "kP", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"J", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"-", "1"}], "+", "n"}], ",", 
        RowBox[{"kP", " ", "r"}]}], "]"}], "-", 
      RowBox[{"J", "[", 
       RowBox[{
        RowBox[{"1", "+", "n"}], ",", 
        RowBox[{"kP", " ", "r"}]}], "]"}]}], ")"}]}], ",", 
   FractionBox[
    RowBox[{"\[ImaginaryI]", " ", "n", " ", 
     RowBox[{"J", "[", 
      RowBox[{"n", ",", 
       RowBox[{"kP", " ", "r"}]}], "]"}]}], "r"]}], "}"}]], "Output",
 CellChangeTimes->{3.872054876784308*^9},
 CellLabel->
  "Out[153]=",ExpressionUUID->"a75647d2-2505-40b6-9043-7b8c243d35ac"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   FractionBox[
    RowBox[{"\[ImaginaryI]", " ", "n", " ", 
     RowBox[{"J", "[", 
      RowBox[{"n", ",", 
       RowBox[{"kS", " ", "r"}]}], "]"}]}], "r"], ",", 
   RowBox[{
    RowBox[{"-", 
     FractionBox["1", "2"]}], " ", "kS", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"J", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"-", "1"}], "+", "n"}], ",", 
        RowBox[{"kS", " ", "r"}]}], "]"}], "-", 
      RowBox[{"J", "[", 
       RowBox[{
        RowBox[{"1", "+", "n"}], ",", 
        RowBox[{"kS", " ", "r"}]}], "]"}]}], ")"}]}]}], "}"}]], "Output",
 CellChangeTimes->{3.872054876791917*^9},
 CellLabel->
  "Out[154]=",ExpressionUUID->"0d3b6458-49fb-4b7f-bb4a-b2c3793c29e8"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  StyleBox[
   RowBox[{
    RowBox[{
    "Formulate", " ", "the", " ", "matrix", " ", "M", " ", "and", " ", "do", 
     " ", "some", " ", "numerical", " ", "checks"}], ";"}], "Subsubsection"], 
  "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{"The", " ", "simplest", " ", "direct", " ", 
    RowBox[{"problem", ":", " ", 
     RowBox[{
     "specify", " ", "the", " ", "forcing", " ", "everywhere", " ", "on", " ",
       "an", " ", "inner", " ", "and", " ", "outer", " ", "radius"}]}]}], 
   "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
   "This", " ", "allows", " ", "for", " ", "a", " ", "Fourier", " ", "type", 
    " ", "solution", " ", "shown", " ", "below"}], "*)"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"eqs", " ", "=", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{"\[CapitalSigma]modes", "/.", 
      RowBox[{"r", "->", " ", "r1"}]}], ")"}], "~", "Join", "~", 
    RowBox[{"(", 
     RowBox[{"\[CapitalSigma]modes", "/.", 
      RowBox[{"r", "->", "r2"}]}], ")"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"coes", " ", "=", " ", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"a", "[", "n", "]"}], ",", 
     RowBox[{"b", "[", "n", "]"}], ",", 
     RowBox[{"c", "[", "n", "]"}], ",", 
     RowBox[{"d", "[", "n", "]"}]}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"M", " ", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"Coefficient", "[", 
      RowBox[{
       RowBox[{"eqs", "/", 
        SuperscriptBox["\[ExponentialE]", 
         RowBox[{"\[ImaginaryI]", " ", "n", " ", "\[Theta]"}]]}], " ", ",", 
       "#"}], "]"}], "&"}], "/@", "coes"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"M", " ", "=", " ", 
    RowBox[{
     RowBox[{"M", "\[Transpose]"}], " ", "//", "Simplify"}]}], ";"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"A", " ", "quick", " ", "check"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"M", ".", "coes"}], " ", "==", " ", 
    RowBox[{"eqs", "/", 
     SuperscriptBox["\[ExponentialE]", 
      RowBox[{"\[ImaginaryI]", " ", "n", " ", "\[Theta]"}]]}]}], " ", " ", "//",
    "Simplify"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", "M"}], "Input",
 CellChangeTimes->{{3.864723472775882*^9, 3.864723675391049*^9}, {
   3.864723738880978*^9, 3.864723768648274*^9}, {3.864723803198847*^9, 
   3.864723841405751*^9}, {3.864723873954837*^9, 3.864723882945158*^9}, {
   3.8647239195419292`*^9, 3.864723994830779*^9}, {3.864724086518701*^9, 
   3.8647241003966513`*^9}, {3.864737732889851*^9, 3.8647377362458887`*^9}, {
   3.864739145995287*^9, 3.864739146233411*^9}, {3.864739190241481*^9, 
   3.864739218610561*^9}, {3.8647397913258343`*^9, 3.864739811768305*^9}, {
   3.8647403938162746`*^9, 3.8647404050644493`*^9}, {3.8647450761088743`*^9, 
   3.864745076545928*^9}, {3.864745198101089*^9, 3.8647452618247213`*^9}, {
   3.864745300777547*^9, 3.864745305212591*^9}, {3.864791124754846*^9, 
   3.864791136156358*^9}, {3.8667066611633577`*^9, 3.866706661895849*^9}, 
   3.866706920742536*^9, {3.866792435008376*^9, 3.866792436487706*^9}, {
   3.8667925066241493`*^9, 3.8667925872734823`*^9}, {3.8667926831917257`*^9, 
   3.866792756362186*^9}, {3.8667928324571133`*^9, 3.866792870863624*^9}, {
   3.866792936022708*^9, 3.866793030638735*^9}, {3.8667930656751757`*^9, 
   3.866793130127613*^9}, {3.866793246608665*^9, 3.8667932483735523`*^9}, {
   3.866793286984655*^9, 3.866793300493072*^9}, {3.8667935040644007`*^9, 
   3.866793519951168*^9}, {3.872053588331056*^9, 3.8720536594163733`*^9}, {
   3.872053813932008*^9, 3.872053835710805*^9}, {3.8720545707525454`*^9, 
   3.872054585958148*^9}},ExpressionUUID->"387c52ca-2a41-4ddf-a45c-\
cc425a515f0a"],

Cell[BoxData["True"], "Output",
 CellChangeTimes->{
  3.8667069213480787`*^9, {3.866792654540351*^9, 3.8667926752030973`*^9}},
 CellLabel->"Out[70]=",ExpressionUUID->"8948a7bf-9917-44b3-9b1b-0533f06883ba"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"Numerical", " ", "check", " ", "of", " ", "stability"}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"Even", " ", "with", " ", "condition", " ", "number", " ", 
     SuperscriptBox["10", 
      RowBox[{"8", " "}]], "we", " ", "can", " ", "still", " ", "get", " ", 
     "solutions", " ", "with", " ", "accuracy", " ", "around", " ", 
     SuperscriptBox["10", 
      RowBox[{"-", "8"}]]}], ",", " ", 
    RowBox[{"this", " ", "is", " ", "because", " ", "Float64"}], ",", " ", 
    RowBox[{
    "the", " ", "most", " ", "common", " ", "floating", " ", "number", " ", 
     "has", " ", "a", " ", "precision", " ", "of", " ", 
     SuperscriptBox["10", 
      RowBox[{"-", "16"}]]}]}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"subN", " ", "=", " ", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"cS", " ", "->", " ", "1.0"}], ",", " ", 
       RowBox[{"cP", " ", "->", " ", "2.0"}], ",", 
       RowBox[{"r1", " ", "->", " ", "0.5"}], ",", 
       RowBox[{"r2", " ", "->", " ", "1.0"}], ",", 
       RowBox[{"\[Rho]", "->", " ", "1.0"}]}], "}"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"NM", " ", "=", " ", 
     RowBox[{
      RowBox[{"M", "/.", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"\[Theta]", "->", "0"}], " ", ",", 
         RowBox[{"kP", " ", "->", " ", 
          RowBox[{"\[Omega]", "/", "cP"}]}], ",", 
         RowBox[{"kS", " ", "->", " ", 
          RowBox[{"\[Omega]", "/", "cS"}]}]}], "}"}]}], "//.", "subN"}]}], 
    ";"}], "\[IndentingNewLine]", "\n", 
   RowBox[{
    RowBox[{"n0", " ", "=", " ", "6"}], ";", 
    RowBox[{"\[Omega]0", " ", "=", " ", "5.1"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Nb", " ", "=", " ", 
     RowBox[{"RandomReal", "[", 
      RowBox[{"4", ",", "4"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Ncoes", " ", "=", " ", 
     RowBox[{"LinearSolve", "[", 
      RowBox[{
       RowBox[{"NM", "/.", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"n", "->", "n0"}], ",", 
          RowBox[{"\[Omega]", " ", "->", "\[Omega]0"}]}], " ", "}"}]}], ",", 
       "Nb"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Norm", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"NM", ".", "Ncoes"}], " ", "-", " ", "Nb"}], "/.", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"n", "->", "n0"}], ",", 
        RowBox[{"\[Omega]", " ", "->", "\[Omega]0"}]}], " ", "}"}]}], "]"}], 
    " ", "/", " ", 
    RowBox[{"Norm", "[", "Nb", "]"}]}]}]}]], "Input",
 CellChangeTimes->CompressedData["
1:eJxTTMoPSmViYGAQBmIQzXZFginh9BvHyuYcaRD90yBGGUSv3CeiDqK/xKRp
g+hXv3UMQDRbn50JiN5jF2cKomvCP1qC6H1To5xBtPHMC34gOuIDbyKIXrje
OQ1EX5vIngGiTYN3/U4D0nO4X/4H0R9MPqqkA2mtjEmqIPobu5QPiP6ztsoX
RC+7oJQMovcsTgLTISuFMkG0S+bRHBD942BSMYieZHC5FERPsXleBaLPerI3
gugeYZ4tIPqZ0eNtIJqjdPc+EJ1Ur34QRJ9wUP4CotuOcf0A0cvL3f+BaDZF
UZYMkDm2dzRBdO/KQn0QDQBRcKIN
  "],
 CellLabel->"In[26]:=",ExpressionUUID->"e348ad66-6610-49f7-ac8c-1120c0dd718d"],

Cell[BoxData["3.0457382833174`*^-15"], "Output",
 CellChangeTimes->{{3.864740205778184*^9, 3.864740220462573*^9}, 
   3.864745326545327*^9, {3.864790754886235*^9, 3.864790756497991*^9}, 
   3.864796966310865*^9},
 CellLabel->"Out[31]=",ExpressionUUID->"7bffe31b-8708-481b-82c4-d35b7686e1ab"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
    "A", " ", "bit", " ", "of", " ", "a", " ", "strange", " ", "pattern"}], 
    ",", " ", 
    RowBox[{"am", " ", "not", " ", "sure", " ", "why"}]}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"CondNum", "[", "A_", "]"}], ":=", "  ", 
    RowBox[{"(", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"sv", " ", "=", " ", 
       RowBox[{"SingularValueList", "[", 
        RowBox[{"A", "/.", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"n", "->", "n0"}], ",", 
           RowBox[{"\[Omega]", " ", "->", "\[Omega]0"}]}], " ", "}"}]}], 
        "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"sv", "[", 
        RowBox[{"[", "1", "]"}], "]"}], "/", 
       RowBox[{"Last", "@", "sv"}]}]}], "\[IndentingNewLine]", ")"}]}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"\[Omega]s", "=", 
     RowBox[{"Range", "[", 
      RowBox[{"0.1", ",", "1.5", ",", "0.004"}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"CondNum", "[", 
       RowBox[{"NM", "/.", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"n", "->", "4"}], ",", 
          RowBox[{"\[Omega]", " ", "->", "#"}]}], " ", "}"}]}], "]"}], "&"}], 
     "/@", "\[Omega]s"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"ListPlot", "[", 
    RowBox[{
     RowBox[{"Transpose", "[", 
      RowBox[{"{", 
       RowBox[{"\[Omega]s", ",", "%"}], "}"}], "]"}], ",", 
     RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"I", "'"}], "m", " ", "guessing", " ", "the", " ", "peaks", " ", 
     "are", " ", "the", " ", "resonant", " ", 
     RowBox[{"frequencies", "?"}]}], "*)"}]}]}]], "Input",
 CellChangeTimes->CompressedData["
1:eJxTTMoPSmViYGAQAWIQzXZFginh9BvHyuYcaRD90yBGGUSv3CeiDqK/xKRp
g+hXv3UMQDRbn50JiN5jF2cKomvCP1qC6H1To5xBtPHMC34gOuIDbyKIXrje
OQ1EX5vIngGiTYN3/U4D0nO4X/4H0R9MPqqkA2mtjEmqIPobu5QPiP6ztsoX
RC+7oJQMovcsTgLTISuFMkG0S+bRHBD942BSMYieZHC5FERPsXleBaLPerI3
gugeYZ4tIPqZ0eNtIJqjdPc+EJ1Ur34QRJ9wUP4CotuOcf0A0cvL3f+B6Fnl
ulwZQNpjw1wBEC3BdVIHRL9jb73bAKSdzHY9AtEAzLirSA==
  "],
 CellLabel->"In[36]:=",ExpressionUUID->"86804f68-5199-4c83-8410-d9a6a2321448"],

Cell[BoxData[
 GraphicsBox[{{}, 
   {RGBColor[0.368417, 0.506779, 0.709798], PointSize[0.007333333333333334], 
    AbsoluteThickness[1.6], PointBox[CompressedData["
1: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
wg==
     "]]}, {{}, {}}},
  AspectRatio->NCache[GoldenRatio^(-1), 0.6180339887498948],
  Axes->{True, True},
  AxesLabel->{None, None},
  AxesOrigin->{0.0708333333333335, 0},
  DisplayFunction->Identity,
  Frame->{{False, False}, {False, False}},
  FrameLabel->{{None, None}, {None, None}},
  FrameTicks->{{Automatic, Automatic}, {Automatic, Automatic}},
  GridLines->{None, None},
  GridLinesStyle->Directive[
    GrayLevel[0.5, 0.4]],
  Method->{
   "OptimizePlotMarkers" -> True, "OptimizePlotMarkers" -> True, 
    "CoordinatesToolOptions" -> {"DisplayFunction" -> ({
        Identity[
         Part[#, 1]], 
        Identity[
         Part[#, 2]]}& ), "CopiedValueFunction" -> ({
        Identity[
         Part[#, 1]], 
        Identity[
         Part[#, 2]]}& )}},
  PlotRange->{{0.0708333333333335, 1.5}, {0, 4.1394636745393*^13}},
  PlotRangeClipping->True,
  PlotRangePadding->{{
     Scaled[0.02], 
     Scaled[0.02]}, {
     Scaled[0.02], 
     Scaled[0.05]}},
  Ticks->{Automatic, Automatic}]], "Output",
 CellChangeTimes->{{3.8647399739618053`*^9, 3.864740058752124*^9}, {
   3.864740089216819*^9, 3.864740155258497*^9}, 3.864740199685498*^9, 
   3.8647453280303793`*^9, {3.864790760328319*^9, 3.864790807161832*^9}, 
   3.864796969531507*^9, 3.8647970120055027`*^9},
 CellLabel->"Out[39]=",ExpressionUUID->"80f3c367-0ce7-4d76-93aa-88c2e42574f3"]
}, Open  ]],

Cell[BoxData[
 StyleBox[
  RowBox[{"The", " ", "principal", " ", "of", " ", "virtual", " ", "work"}], 
  "Subsubsection"]], "Input",
 CellChangeTimes->{{3.864791670134821*^9, 3.864791769073585*^9}, {
  3.864792206821254*^9, 3.864792214879127*^9}, {3.8968429451516237`*^9, 
  3.896842949006399*^9}},ExpressionUUID->"c08a5ac0-875f-470c-832c-\
c6ccd0f14aea"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
   "first", " ", "just", " ", "check", " ", "local", " ", "balance", " ", 
    "of", " ", "momentum", " ", "from", " ", "one", " ", "mode"}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"ClearAll", "[", "n", "]"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"Laplacian", "[", 
      RowBox[{
       RowBox[{"\[Phi]", "/.", "submodes"}], ",", 
       RowBox[{"{", 
        RowBox[{"r", ",", "\[Theta]", ",", "z"}], "}"}], ",", 
       "\"\<Cylindrical\>\""}], "]"}], "+", 
     RowBox[{
      RowBox[{"kP", "^", "2"}], 
      RowBox[{"(", 
       RowBox[{"\[Phi]", "/.", "submodes"}], ")"}]}]}], "//", 
    "FullSimplify"}]}]}]], "Input",
 CellChangeTimes->{{3.8647917700674963`*^9, 3.8647918426961718`*^9}, {
   3.864791968815819*^9, 3.864792027041889*^9}, {3.864792060318007*^9, 
   3.864792060847393*^9}, {3.86479212025788*^9, 3.864792204446488*^9}, 
   3.896842952400343*^9, {3.896842998351715*^9, 3.896842999134282*^9}, {
   3.8968434486073637`*^9, 3.8968434631421633`*^9}, 3.8968435047412453`*^9, {
   3.896843558964736*^9, 3.896843572632375*^9}, 3.896843637252849*^9, {
   3.89684406086014*^9, 3.8968440654437313`*^9}, {3.896844934017168*^9, 
   3.8968450263912983`*^9}, {3.896845077018159*^9, 3.8968453108895807`*^9}, {
   3.896845368172686*^9, 3.896845477099545*^9}, 3.896845510081805*^9, {
   3.896845657785811*^9, 3.8968456614567127`*^9}, {3.896845737369556*^9, 
   3.896845838873877*^9}, {3.896845881984984*^9, 3.896845907567315*^9}, 
   3.896845985307794*^9, 3.896846049369856*^9},
 CellLabel->"In[31]:=",ExpressionUUID->"aa78a95b-2905-4bcd-8c0d-cc3dc8fb9fdc"],

Cell[BoxData["0"], "Output",
 CellChangeTimes->{3.8968482349325743`*^9},
 CellLabel->"Out[32]=",ExpressionUUID->"7402f355-7d3f-4d13-8d88-2df342293216"]
}, Open  ]],

Cell[BoxData[{
 RowBox[{
  RowBox[{"displace", " ", "=", " ", 
   RowBox[{"ufun", "[", 
    RowBox[{
     RowBox[{"\[Phi]", "/.", "submodes"}], ",", 
     RowBox[{"\[Psi]", "/.", "submodes"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"stress", " ", "=", 
   RowBox[{"(", 
    RowBox[{"\[Sigma]fun", "@", 
     RowBox[{"\[Epsilon]fun", "@", 
      RowBox[{"ufun", "[", 
       RowBox[{
        RowBox[{"\[Phi]", "/.", "submodes"}], ",", 
        RowBox[{"\[Psi]", "/.", "submodes"}]}], "]"}]}]}], ")"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Divstress", "=", " ", 
    RowBox[{"Div", "[", 
     RowBox[{"stress", ",", 
      RowBox[{"{", 
       RowBox[{"r", ",", "\[Theta]", ",", "z"}], "}"}], ",", 
      "\"\<Cylindrical\>\""}], "]"}]}], " ", ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{
      SuperscriptBox[
       RowBox[{"\[Omega]", " "}], "2"], "\[Rho]", " ", "umodes"}], "+", 
     RowBox[{"Divstress", "[", 
      RowBox[{"[", 
       RowBox[{"1", ";;", "2"}], "]"}], "]"}]}], "//.", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"\[Mu]", " ", "->", " ", 
       RowBox[{"\[Rho]", " ", 
        SuperscriptBox["cS", "2"]}]}], ",", 
      RowBox[{"\[Lambda]", " ", "->", " ", 
       RowBox[{
        RowBox[{"\[Rho]", " ", 
         SuperscriptBox["cP", "2"]}], "-", 
        RowBox[{"2", " ", "\[Mu]"}]}]}]}], "}"}]}], "/.", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"cS", " ", "->", " ", 
      RowBox[{"\[Omega]", "/", "kS"}]}], ",", 
     RowBox[{"cP", " ", "->", " ", 
      RowBox[{"\[Omega]", "/", "kP"}]}]}], "}"}]}], " ", "//", 
  "FullSimplify"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"-", "Divstress"}], " ", "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"\[Lambda]", "+", "\[Mu]"}], ")"}], 
       RowBox[{"Grad", "[", 
        RowBox[{
         RowBox[{"Div", "[", 
          RowBox[{"displace", ",", 
           RowBox[{"{", 
            RowBox[{"r", ",", "\[Theta]", ",", "z"}], "}"}], ",", 
           "\"\<Cylindrical\>\""}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"r", ",", "\[Theta]", ",", "z"}], "}"}], ",", 
         "\"\<Cylindrical\>\""}], "]"}]}], " ", "+", " ", 
      RowBox[{"\[Mu]", " ", 
       RowBox[{"Laplacian", "[", 
        RowBox[{"displace", ",", 
         RowBox[{"{", 
          RowBox[{"r", ",", "\[Theta]", ",", "z"}], "}"}], ",", 
         "\"\<Cylindrical\>\""}], "]"}]}]}], " ", "//.", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"\[Mu]", " ", "->", " ", 
        RowBox[{"\[Rho]", " ", 
         SuperscriptBox["cS", "2"]}]}], ",", 
       RowBox[{"\[Lambda]", " ", "->", " ", 
        RowBox[{
         RowBox[{"\[Rho]", " ", 
          SuperscriptBox["cP", "2"]}], "-", 
         RowBox[{"2", " ", "\[Mu]"}]}]}]}], "}"}]}], "//.", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"cS", " ", "->", " ", 
       RowBox[{"\[Omega]", "/", "kS"}]}], ",", 
      RowBox[{"cP", " ", "->", " ", 
       RowBox[{"\[Omega]", "/", "kP"}]}]}], "}"}]}], " ", "//", 
   "FullSimplify"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]"}], "Input",\

 CellChangeTimes->{{3.8647917700674963`*^9, 3.8647918426961718`*^9}, {
   3.864791968815819*^9, 3.864792027041889*^9}, {3.864792060318007*^9, 
   3.864792060847393*^9}, {3.86479212025788*^9, 3.864792204446488*^9}, 
   3.896842952400343*^9, {3.896842998351715*^9, 3.896842999134282*^9}, {
   3.8968434486073637`*^9, 3.8968434631421633`*^9}, 3.8968435047412453`*^9, {
   3.896843558964736*^9, 3.896843572632375*^9}, 3.896843637252849*^9, {
   3.89684406086014*^9, 3.8968440654437313`*^9}, {3.896844934017168*^9, 
   3.8968450263912983`*^9}, {3.896845077018159*^9, 3.8968453108895807`*^9}, {
   3.896845368172686*^9, 3.896845477099545*^9}, 3.896845510081805*^9, {
   3.896845657785811*^9, 3.8968456614567127`*^9}, {3.896845737369556*^9, 
   3.896845838873877*^9}, {3.896845881984984*^9, 3.896845907567315*^9}, 
   3.896845985307794*^9, 3.896846049369856*^9, {3.8968460942935333`*^9, 
   3.8968461179344463`*^9}, {3.896846213189807*^9, 3.896846241647983*^9}, {
   3.896846612515317*^9, 3.89684671030781*^9}, 3.896847164739204*^9, {
   3.896858578626734*^9, 
   3.896858578890403*^9}},ExpressionUUID->"762154bb-a303-4485-8d10-\
96930f4ffeb2"],

Cell[BoxData[
 RowBox[{
  RowBox[{"{", 
   RowBox[{
    RowBox[{"\[Mu]", " ", "->", " ", 
     RowBox[{"\[Rho]", " ", 
      SuperscriptBox["cS", "2"]}]}], ",", 
    RowBox[{"\[Lambda]", " ", "->", " ", 
     RowBox[{
      RowBox[{"\[Rho]", " ", 
       SuperscriptBox["cP", "2"]}], "-", 
      RowBox[{"2", " ", "\[Mu]"}]}]}]}], "}"}], "/.", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"cS", " ", "->", " ", 
     RowBox[{"\[Omega]", "/", "kS"}]}], ",", 
    RowBox[{"cP", " ", "->", " ", 
     RowBox[{"\[Omega]", "/", "kP"}]}]}], "}"}], " "}]], "Input",
 CellChangeTimes->{{3.8647917700674963`*^9, 3.8647918426961718`*^9}, {
   3.864791968815819*^9, 3.864792027041889*^9}, {3.864792060318007*^9, 
   3.864792060847393*^9}, {3.86479212025788*^9, 3.864792204446488*^9}, 
   3.896842952400343*^9, {3.896842998351715*^9, 3.896842999134282*^9}, {
   3.8968434486073637`*^9, 3.8968434631421633`*^9}, 3.8968435047412453`*^9, {
   3.896843558964736*^9, 3.896843572632375*^9}, 3.896843637252849*^9, {
   3.89684406086014*^9, 3.8968440654437313`*^9}, {3.896844934017168*^9, 
   3.8968450263912983`*^9}, {3.896845077018159*^9, 3.8968453108895807`*^9}, {
   3.896845368172686*^9, 3.896845477099545*^9}, 3.896845510081805*^9, {
   3.896845657785811*^9, 3.8968456614567127`*^9}, {3.896845737369556*^9, 
   3.896845838873877*^9}, {3.896845881984984*^9, 3.896845907567315*^9}, 
   3.896845985307794*^9, 3.896846049369856*^9, {3.8968460942935333`*^9, 
   3.8968461179344463`*^9}, {3.896846213189807*^9, 3.896846241647983*^9}, {
   3.896846612515317*^9, 3.89684671030781*^9}, 3.896847164739204*^9, {
   3.896858578626734*^9, 3.8968585803565598`*^9}, 3.8968586774927683`*^9},
 CellLabel->"In[10]:=",ExpressionUUID->"7c9e1b0d-ffeb-4c4b-a400-eed0f72d870f"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"\[Mu]", "\[Rule]", 
    FractionBox[
     RowBox[{"\[Rho]", " ", 
      SuperscriptBox["\[Omega]", "2"]}], 
     SuperscriptBox["kS", "2"]]}], ",", 
   RowBox[{"\[Lambda]", "\[Rule]", 
    RowBox[{
     RowBox[{
      RowBox[{"-", "2"}], " ", 
      FractionBox[
       RowBox[{"\[Rho]", " ", 
        SuperscriptBox["\[Omega]", "2"]}], 
       SuperscriptBox["kS", "2"]]}], "+", 
     FractionBox[
      RowBox[{"\[Rho]", " ", 
       SuperscriptBox["\[Omega]", "2"]}], 
      SuperscriptBox["kP", "2"]]}]}]}], "}"}]], "Input",
 CellChangeTimes->{{3.896858588734104*^9, 
  3.89685858873699*^9}},ExpressionUUID->"d3b5a10a-1df7-4e5c-a6dd-\
75777c1d6255"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"For", " ", "the", " ", "virtual", " ", "displacement"}], ",", 
    " ", 
    RowBox[{"or", " ", "test", " ", "function"}], ",", " ", 
    RowBox[{"we", " ", "use"}]}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"W", " ", "=", " ", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"w", "[", "1", "]"}], ",", 
        RowBox[{"w", "[", "2", "]"}], ",", 
        RowBox[{"w", "[", "3", "]"}]}], "}"}], 
      RowBox[{"BesselJ", "[", 
       RowBox[{"m", ",", 
        RowBox[{"kw", " ", "r"}]}], "]"}], 
      SuperscriptBox["\[ExponentialE]", 
       RowBox[{
        RowBox[{"-", " ", "\[ImaginaryI]"}], " ", "n", " ", "\[Theta]"}]]}]}],
     ";"}], "\[IndentingNewLine]", 
   RowBox[{"GradW", " ", "=", " ", 
    RowBox[{"Grad", "[", 
     RowBox[{"W", ",", 
      RowBox[{"{", 
       RowBox[{"r", ",", "\[Theta]", ",", "z"}], "}"}], ",", 
      "\"\<Cylindrical\>\""}], "]"}]}], " ", "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"stress", "[", 
         RowBox[{"[", "1", "]"}], "]"}], "[", 
        RowBox[{"[", 
         RowBox[{"1", ";;", "2"}], "]"}], "]"}], "==", " ", 
       RowBox[{"\[CapitalSigma]", "[", 
        RowBox[{
         RowBox[{"\[Phi]", "/.", "submodes"}], ",", 
         RowBox[{"\[Psi]", "/.", "submodes"}]}], "]"}]}], " ", "//.", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"\[Mu]", " ", "->", " ", 
         RowBox[{"\[Rho]", " ", 
          SuperscriptBox["cS", "2"]}]}], ",", 
        RowBox[{"\[Lambda]", " ", "->", " ", 
         RowBox[{
          RowBox[{"\[Rho]", " ", 
           SuperscriptBox["cP", "2"]}], "-", 
          RowBox[{"2", " ", "\[Mu]"}]}]}]}], "}"}]}], " ", "/.", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"cS", " ", "->", " ", 
        RowBox[{"\[Omega]", "/", "kS"}]}], ",", 
       RowBox[{"cP", " ", "->", " ", 
        RowBox[{"\[Omega]", "/", "kP"}]}]}], "}"}]}], " ", "//", 
    "FullSimplify"}], "\[IndentingNewLine]", "\[IndentingNewLine]", " ", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"\[CapitalSigma]", "[", 
       RowBox[{
        RowBox[{"\[Phi]", "/.", "submodes"}], ",", 
        RowBox[{"\[Psi]", "/.", "submodes"}]}], "]"}], " ", ",", 
      "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"\[CapitalSigma]", "[", 
         RowBox[{
          RowBox[{"\[Phi]", "/.", "submodes"}], ",", 
          RowBox[{"\[Psi]", "/.", "submodes"}]}], "]"}], "[", 
        RowBox[{"[", "2", "]"}], "]"}], "}"}]}], " ", "}"}], ";"}], 
   "\[IndentingNewLine]"}]}]], "Input",
 CellChangeTimes->{{3.8647917700674963`*^9, 3.8647918426961718`*^9}, {
   3.864791968815819*^9, 3.864792027041889*^9}, {3.864792060318007*^9, 
   3.864792060847393*^9}, {3.86479212025788*^9, 3.864792204446488*^9}, 
   3.896842952400343*^9, {3.896842998351715*^9, 3.896842999134282*^9}, {
   3.8968434486073637`*^9, 3.8968434631421633`*^9}, 3.8968435047412453`*^9, {
   3.896843558964736*^9, 3.896843572632375*^9}, 3.896843637252849*^9, {
   3.89684406086014*^9, 3.8968440654437313`*^9}, {3.896844934017168*^9, 
   3.8968450263912983`*^9}, {3.896845077018159*^9, 3.8968453108895807`*^9}, {
   3.896845368172686*^9, 3.896845477099545*^9}, 3.896845510081805*^9, {
   3.896845657785811*^9, 3.8968456614567127`*^9}, {3.896845737369556*^9, 
   3.896845838873877*^9}, {3.896845881984984*^9, 3.896845907567315*^9}, 
   3.896845985307794*^9, 3.896846049369856*^9, {3.8968460942935333`*^9, 
   3.8968461179344463`*^9}, {3.896846213189807*^9, 3.896846241647983*^9}, {
   3.896846612515317*^9, 3.89684671030781*^9}, {3.896847164739204*^9, 
   3.896847201137719*^9}, {3.896847702409129*^9, 3.8968477893061657`*^9}, {
   3.896848242930023*^9, 3.8968484018310127`*^9}, {3.896848662727075*^9, 
   3.8968486648667307`*^9}},
 CellLabel->"In[82]:=",ExpressionUUID->"3ca3453f-87de-41db-8e1c-569768423cbc"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      FractionBox["1", "2"], " ", 
      SuperscriptBox["\[ExponentialE]", 
       RowBox[{
        RowBox[{"-", "\[ImaginaryI]"}], " ", "n", " ", "\[Theta]"}]], " ", 
      "kw", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"BesselJ", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"-", "1"}], "+", "m"}], ",", 
          RowBox[{"kw", " ", "r"}]}], "]"}], "-", 
        RowBox[{"BesselJ", "[", 
         RowBox[{
          RowBox[{"1", "+", "m"}], ",", 
          RowBox[{"kw", " ", "r"}]}], "]"}]}], ")"}], " ", 
      RowBox[{"w", "[", "1", "]"}]}], ",", 
     FractionBox[
      RowBox[{
       RowBox[{
        RowBox[{"-", "\[ImaginaryI]"}], " ", 
        SuperscriptBox["\[ExponentialE]", 
         RowBox[{
          RowBox[{"-", "\[ImaginaryI]"}], " ", "n", " ", "\[Theta]"}]], " ", 
        "n", " ", 
        RowBox[{"BesselJ", "[", 
         RowBox[{"m", ",", 
          RowBox[{"kw", " ", "r"}]}], "]"}], " ", 
        RowBox[{"w", "[", "1", "]"}]}], "-", 
       RowBox[{
        SuperscriptBox["\[ExponentialE]", 
         RowBox[{
          RowBox[{"-", "\[ImaginaryI]"}], " ", "n", " ", "\[Theta]"}]], " ", 
        RowBox[{"BesselJ", "[", 
         RowBox[{"m", ",", 
          RowBox[{"kw", " ", "r"}]}], "]"}], " ", 
        RowBox[{"w", "[", "2", "]"}]}]}], "r"], ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      FractionBox["1", "2"], " ", 
      SuperscriptBox["\[ExponentialE]", 
       RowBox[{
        RowBox[{"-", "\[ImaginaryI]"}], " ", "n", " ", "\[Theta]"}]], " ", 
      "kw", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"BesselJ", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"-", "1"}], "+", "m"}], ",", 
          RowBox[{"kw", " ", "r"}]}], "]"}], "-", 
        RowBox[{"BesselJ", "[", 
         RowBox[{
          RowBox[{"1", "+", "m"}], ",", 
          RowBox[{"kw", " ", "r"}]}], "]"}]}], ")"}], " ", 
      RowBox[{"w", "[", "2", "]"}]}], ",", 
     FractionBox[
      RowBox[{
       RowBox[{
        SuperscriptBox["\[ExponentialE]", 
         RowBox[{
          RowBox[{"-", "\[ImaginaryI]"}], " ", "n", " ", "\[Theta]"}]], " ", 
        RowBox[{"BesselJ", "[", 
         RowBox[{"m", ",", 
          RowBox[{"kw", " ", "r"}]}], "]"}], " ", 
        RowBox[{"w", "[", "1", "]"}]}], "-", 
       RowBox[{"\[ImaginaryI]", " ", 
        SuperscriptBox["\[ExponentialE]", 
         RowBox[{
          RowBox[{"-", "\[ImaginaryI]"}], " ", "n", " ", "\[Theta]"}]], " ", 
        "n", " ", 
        RowBox[{"BesselJ", "[", 
         RowBox[{"m", ",", 
          RowBox[{"kw", " ", "r"}]}], "]"}], " ", 
        RowBox[{"w", "[", "2", "]"}]}]}], "r"], ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      FractionBox["1", "2"], " ", 
      SuperscriptBox["\[ExponentialE]", 
       RowBox[{
        RowBox[{"-", "\[ImaginaryI]"}], " ", "n", " ", "\[Theta]"}]], " ", 
      "kw", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"BesselJ", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"-", "1"}], "+", "m"}], ",", 
          RowBox[{"kw", " ", "r"}]}], "]"}], "-", 
        RowBox[{"BesselJ", "[", 
         RowBox[{
          RowBox[{"1", "+", "m"}], ",", 
          RowBox[{"kw", " ", "r"}]}], "]"}]}], ")"}], " ", 
      RowBox[{"w", "[", "3", "]"}]}], ",", 
     RowBox[{"-", 
      FractionBox[
       RowBox[{"\[ImaginaryI]", " ", 
        SuperscriptBox["\[ExponentialE]", 
         RowBox[{
          RowBox[{"-", "\[ImaginaryI]"}], " ", "n", " ", "\[Theta]"}]], " ", 
        "n", " ", 
        RowBox[{"BesselJ", "[", 
         RowBox[{"m", ",", 
          RowBox[{"kw", " ", "r"}]}], "]"}], " ", 
        RowBox[{"w", "[", "3", "]"}]}], "r"]}], ",", "0"}], "}"}]}], 
  "}"}]], "Output",
 CellChangeTimes->{{3.8968486632952223`*^9, 3.896848665190771*^9}},
 CellLabel->"Out[83]=",ExpressionUUID->"0d623c6b-3e02-4cf9-9a6d-d5151f854ce1"],

Cell[BoxData["True"], "Output",
 CellChangeTimes->{{3.8968486632952223`*^9, 3.8968486651941338`*^9}},
 CellLabel->"Out[84]=",ExpressionUUID->"70e50812-ca73-4329-b59c-f93ef0164b81"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"stress", "[", 
   RowBox[{"[", 
    RowBox[{"2", ",", "2"}], "]"}], "]"}], "//", "FullSimplify"}]], "Input",
 CellChangeTimes->{{3.8647917700674963`*^9, 3.8647918426961718`*^9}, {
   3.864791968815819*^9, 3.864792027041889*^9}, {3.864792060318007*^9, 
   3.864792060847393*^9}, {3.86479212025788*^9, 3.864792204446488*^9}, 
   3.896842952400343*^9, {3.896842998351715*^9, 3.896842999134282*^9}, {
   3.8968434486073637`*^9, 3.8968434631421633`*^9}, 3.8968435047412453`*^9, {
   3.896843558964736*^9, 3.896843572632375*^9}, 3.896843637252849*^9, {
   3.89684406086014*^9, 3.8968440654437313`*^9}, {3.896844934017168*^9, 
   3.8968450263912983`*^9}, {3.896845077018159*^9, 3.8968453108895807`*^9}, {
   3.896845368172686*^9, 3.896845477099545*^9}, 3.896845510081805*^9, {
   3.896845657785811*^9, 3.8968456614567127`*^9}, {3.896845737369556*^9, 
   3.896845838873877*^9}, {3.896845881984984*^9, 3.896845907567315*^9}, 
   3.896845985307794*^9, 3.896846049369856*^9, {3.8968460942935333`*^9, 
   3.8968461179344463`*^9}, {3.896846213189807*^9, 3.896846241647983*^9}, {
   3.896846612515317*^9, 3.89684671030781*^9}, {3.896847164739204*^9, 
   3.896847201137719*^9}, {3.896847702409129*^9, 3.8968477893061657`*^9}, {
   3.896848242930023*^9, 3.89684840500673*^9}, {3.896848566519355*^9, 
   3.8968485708163157`*^9}},
 CellLabel->"In[77]:=",ExpressionUUID->"0b405d52-8534-419e-9869-23d09233aa2a"],

Cell[BoxData[
 RowBox[{
  FractionBox["1", 
   SuperscriptBox["r", "2"]], 
  RowBox[{
   SuperscriptBox["\[ExponentialE]", 
    RowBox[{"\[ImaginaryI]", " ", "n", " ", "\[Theta]"}]], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      RowBox[{"a", "[", "n", "]"}], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"2", " ", "kP", " ", "r", " ", "\[Mu]", " ", 
         RowBox[{"BesselJ", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"-", "1"}], "+", "n"}], ",", 
           RowBox[{"kP", " ", "r"}]}], "]"}]}], "-", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            SuperscriptBox["kP", "2"], " ", 
            SuperscriptBox["r", "2"], " ", "\[Lambda]"}], "+", 
           RowBox[{"2", " ", "n", " ", 
            RowBox[{"(", 
             RowBox[{"1", "+", "n"}], ")"}], " ", "\[Mu]"}]}], ")"}], " ", 
         RowBox[{"BesselJ", "[", 
          RowBox[{"n", ",", 
           RowBox[{"kP", " ", "r"}]}], "]"}]}]}], ")"}]}], "+", 
     RowBox[{"2", " ", "\[ImaginaryI]", " ", "n", " ", "\[Mu]", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"-", "kS"}], " ", "r", " ", 
         RowBox[{"BesselJ", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"-", "1"}], "+", "n"}], ",", 
           RowBox[{"kS", " ", "r"}]}], "]"}]}], "+", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"1", "+", "n"}], ")"}], " ", 
         RowBox[{"BesselJ", "[", 
          RowBox[{"n", ",", 
           RowBox[{"kS", " ", "r"}]}], "]"}]}]}], ")"}], " ", 
      RowBox[{"c", "[", "n", "]"}]}], "+", 
     RowBox[{"2", " ", "kP", " ", "r", " ", "\[Mu]", " ", 
      RowBox[{"b", "[", "n", "]"}], " ", 
      RowBox[{"HankelH1", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"-", "1"}], "+", "n"}], ",", 
        RowBox[{"kP", " ", "r"}]}], "]"}]}], "-", 
     RowBox[{
     "2", " ", "\[ImaginaryI]", " ", "kS", " ", "n", " ", "r", " ", "\[Mu]", 
      " ", 
      RowBox[{"d", "[", "n", "]"}], " ", 
      RowBox[{"HankelH1", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"-", "1"}], "+", "n"}], ",", 
        RowBox[{"kS", " ", "r"}]}], "]"}]}], "-", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         SuperscriptBox["kP", "2"], " ", 
         SuperscriptBox["r", "2"], " ", "\[Lambda]"}], "+", 
        RowBox[{"2", " ", "n", " ", 
         RowBox[{"(", 
          RowBox[{"1", "+", "n"}], ")"}], " ", "\[Mu]"}]}], ")"}], " ", 
      RowBox[{"b", "[", "n", "]"}], " ", 
      RowBox[{"HankelH1", "[", 
       RowBox[{"n", ",", 
        RowBox[{"kP", " ", "r"}]}], "]"}]}], "+", 
     RowBox[{"2", " ", "\[ImaginaryI]", " ", "n", " ", 
      RowBox[{"(", 
       RowBox[{"1", "+", "n"}], ")"}], " ", "\[Mu]", " ", 
      RowBox[{"d", "[", "n", "]"}], " ", 
      RowBox[{"HankelH1", "[", 
       RowBox[{"n", ",", 
        RowBox[{"kS", " ", "r"}]}], "]"}]}]}], ")"}]}]}]], "Output",
 CellChangeTimes->{{3.896848237977216*^9, 3.8968483688090973`*^9}, 
   3.8968484061721783`*^9, {3.8968485679980507`*^9, 3.896848579330305*^9}},
 CellLabel->"Out[77]=",ExpressionUUID->"eae76e7a-31be-4d0e-b40e-94a67cab522a"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"Grad", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"f1", "[", 
        RowBox[{"r", ",", "\[Theta]"}], "]"}], ",", 
       RowBox[{"f2", "[", 
        RowBox[{"r", ",", "\[Theta]"}], "]"}], ",", 
       RowBox[{"f3", "[", 
        RowBox[{"r", ",", "\[Theta]"}], "]"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"r", ",", "\[Theta]", ",", "z"}], "}"}], ",", 
     "\"\<Cylindrical\>\""}], "]"}], "\[IndentingNewLine]", 
   RowBox[{"Grad", "[", 
    RowBox[{
     RowBox[{"f1", "[", 
      RowBox[{"r", ",", "\[Theta]"}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"r", ",", "\[Theta]", ",", "z"}], "}"}], ",", 
     "\"\<Cylindrical\>\""}], "]"}]}]}]], "Input",
 CellChangeTimes->{{3.8968469007206*^9, 3.896846941466555*^9}},
 CellLabel->
  "In[403]:=",ExpressionUUID->"5a108c5f-0b6a-415e-8f34-9c938f064cd2"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      SuperscriptBox["f1", 
       TagBox[
        RowBox[{"(", 
         RowBox[{"1", ",", "0"}], ")"}],
        Derivative],
       MultilineFunction->None], "[", 
      RowBox[{"r", ",", "\[Theta]"}], "]"}], ",", 
     FractionBox[
      RowBox[{
       RowBox[{"-", 
        RowBox[{"f2", "[", 
         RowBox[{"r", ",", "\[Theta]"}], "]"}]}], "+", 
       RowBox[{
        SuperscriptBox["f1", 
         TagBox[
          RowBox[{"(", 
           RowBox[{"0", ",", "1"}], ")"}],
          Derivative],
         MultilineFunction->None], "[", 
        RowBox[{"r", ",", "\[Theta]"}], "]"}]}], "r"], ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      SuperscriptBox["f2", 
       TagBox[
        RowBox[{"(", 
         RowBox[{"1", ",", "0"}], ")"}],
        Derivative],
       MultilineFunction->None], "[", 
      RowBox[{"r", ",", "\[Theta]"}], "]"}], ",", 
     FractionBox[
      RowBox[{
       RowBox[{"f1", "[", 
        RowBox[{"r", ",", "\[Theta]"}], "]"}], "+", 
       RowBox[{
        SuperscriptBox["f2", 
         TagBox[
          RowBox[{"(", 
           RowBox[{"0", ",", "1"}], ")"}],
          Derivative],
         MultilineFunction->None], "[", 
        RowBox[{"r", ",", "\[Theta]"}], "]"}]}], "r"], ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      SuperscriptBox["f3", 
       TagBox[
        RowBox[{"(", 
         RowBox[{"1", ",", "0"}], ")"}],
        Derivative],
       MultilineFunction->None], "[", 
      RowBox[{"r", ",", "\[Theta]"}], "]"}], ",", 
     FractionBox[
      RowBox[{
       SuperscriptBox["f3", 
        TagBox[
         RowBox[{"(", 
          RowBox[{"0", ",", "1"}], ")"}],
         Derivative],
        MultilineFunction->None], "[", 
       RowBox[{"r", ",", "\[Theta]"}], "]"}], "r"], ",", "0"}], "}"}]}], 
  "}"}]], "Output",
 CellChangeTimes->{{3.8968458394967737`*^9, 3.896845844455826*^9}, {
   3.8968458825137*^9, 3.89684590798392*^9}, 3.8968459856729717`*^9, 
   3.896846051531158*^9, {3.896846105326144*^9, 3.896846118992291*^9}, {
   3.896846220566125*^9, 3.8968462423252287`*^9}, {3.896846626140511*^9, 
   3.896846711035523*^9}, {3.896846918923468*^9, 3.896846941729377*^9}},
 CellLabel->
  "Out[403]=",ExpressionUUID->"58c23918-9121-4e8d-941c-dcca93cb19e9"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{
    SuperscriptBox["f1", 
     TagBox[
      RowBox[{"(", 
       RowBox[{"1", ",", "0"}], ")"}],
      Derivative],
     MultilineFunction->None], "[", 
    RowBox[{"r", ",", "\[Theta]"}], "]"}], ",", 
   FractionBox[
    RowBox[{
     SuperscriptBox["f1", 
      TagBox[
       RowBox[{"(", 
        RowBox[{"0", ",", "1"}], ")"}],
       Derivative],
      MultilineFunction->None], "[", 
     RowBox[{"r", ",", "\[Theta]"}], "]"}], "r"], ",", "0"}], "}"}]], "Output",\

 CellChangeTimes->{{3.8968458394967737`*^9, 3.896845844455826*^9}, {
   3.8968458825137*^9, 3.89684590798392*^9}, 3.8968459856729717`*^9, 
   3.896846051531158*^9, {3.896846105326144*^9, 3.896846118992291*^9}, {
   3.896846220566125*^9, 3.8968462423252287`*^9}, {3.896846626140511*^9, 
   3.896846711035523*^9}, {3.896846918923468*^9, 3.8968469417373457`*^9}},
 CellLabel->
  "Out[404]=",ExpressionUUID->"77a45012-2fc1-4421-9ed9-b365f3e13f0f"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{" ", 
  RowBox[{"Laplacian", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"f1", "[", 
       RowBox[{"r", ",", "\[Theta]"}], "]"}], ",", 
      RowBox[{"f2", "[", 
       RowBox[{"r", ",", "\[Theta]"}], "]"}]}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"r", ",", "\[Theta]", ",", "z"}], "}"}], ",", 
    "\"\<Cylindrical\>\""}], "]"}]}]], "Input",
 CellChangeTimes->{{3.8647917700674963`*^9, 3.8647918426961718`*^9}, {
   3.864791968815819*^9, 3.864792027041889*^9}, {3.864792060318007*^9, 
   3.864792060847393*^9}, {3.86479212025788*^9, 3.864792204446488*^9}, 
   3.896842952400343*^9, {3.896842998351715*^9, 3.896842999134282*^9}, {
   3.8968434486073637`*^9, 3.8968434631421633`*^9}, 3.8968435047412453`*^9, {
   3.896843558964736*^9, 3.896843572632375*^9}, 3.896843637252849*^9, {
   3.89684406086014*^9, 3.8968440654437313`*^9}, {3.896844934017168*^9, 
   3.8968450263912983`*^9}, {3.896845077018159*^9, 3.8968453108895807`*^9}, {
   3.896845368172686*^9, 3.896845477099545*^9}, 3.896845510081805*^9, {
   3.896845657785811*^9, 3.8968456614567127`*^9}, {3.896845737369556*^9, 
   3.8968458203760967`*^9}},
 CellLabel->
  "In[274]:=",ExpressionUUID->"61348b7a-d01d-423b-92d6-650be2ea8c76"],

Cell[BoxData[
 TemplateBox[{
  "Laplacian", "ndimv", 
   "\"There is no \\!\\(\\*RowBox[{\\\"3\\\"}]\\)-dimensional Laplacian for \
the \\!\\(\\*RowBox[{\\\"2\\\"}]\\)-dimensional vector \\!\\(\\*RowBox[{\\\"{\
\\\", RowBox[{RowBox[{\\\"f1\\\", \\\"[\\\", RowBox[{\\\"r\\\", \\\",\\\", \\\
\"\[Theta]\\\"}], \\\"]\\\"}], \\\",\\\", RowBox[{\\\"f2\\\", \\\"[\\\", \
RowBox[{\\\"r\\\", \\\",\\\", \\\"\[Theta]\\\"}], \\\"]\\\"}]}], \
\\\"}\\\"}]\\).\"", 2, 274, 9, 29718213237397895785, "Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.89684582176362*^9},
 CellLabel->
  "During evaluation of \
In[274]:=",ExpressionUUID->"b8ae6de7-6be0-479c-bce2-ee93bc49419c"],

Cell[BoxData[
 RowBox[{"Laplacian", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"f1", "[", 
      RowBox[{"r", ",", "\[Theta]"}], "]"}], ",", 
     RowBox[{"f2", "[", 
      RowBox[{"r", ",", "\[Theta]"}], "]"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"r", ",", "\[Theta]", ",", "z"}], "}"}], 
   ",", "\<\"Cylindrical\"\>"}], "]"}]], "Output",
 CellChangeTimes->{
  3.896845311665751*^9, {3.8968453651591673`*^9, 3.896845392263414*^9}, {
   3.8968454293594627`*^9, 3.896845477419495*^9}, 3.896845661887451*^9, 
   3.89684577507625*^9, 3.896845821788867*^9},
 CellLabel->
  "Out[274]=",ExpressionUUID->"4a823541-6d3e-44fe-b295-d5512529414f"]
}, Open  ]],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"umodes", "=", " ", 
    RowBox[{
     RowBox[{"ufun", "[", 
      RowBox[{
       RowBox[{"\[Phi]", "/.", "submodes"}], ",", 
       RowBox[{"\[Psi]", "/.", "submodes"}]}], "]"}], "[", 
     RowBox[{"[", 
      RowBox[{"1", ";;", "2"}], "]"}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Div", "[", 
   RowBox[{"\[Phi]", ",", 
    RowBox[{"{", 
     RowBox[{"r", ",", "\[Theta]", ",", "z"}], "}"}], ",", 
    "\"\<Cylindrical\>\""}], "]"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Sigma]2", " ", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"(", 
      RowBox[{"\[Sigma]fun", "@", 
       RowBox[{"\[Epsilon]fun", "@", 
        RowBox[{"ufun", "[", 
         RowBox[{"N\[Phi]", " ", ",", "N\[Psi]"}], "]"}]}]}], ")"}], "[", 
     RowBox[{"[", "1", "]"}], "]"}], "[", 
    RowBox[{"[", 
     RowBox[{"1", ";;", "2"}], "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"\[Sigma]2", "-", 
     RowBox[{"\[CapitalSigma]", "[", 
      RowBox[{"N\[Phi]", ",", "N\[Psi]"}], "]"}]}], "//.", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"\[Mu]", " ", "->", " ", 
       RowBox[{"\[Rho]", " ", 
        SuperscriptBox["cS", "2"]}]}], ",", 
      RowBox[{"\[Lambda]", " ", "->", " ", 
       RowBox[{
        RowBox[{"\[Rho]", " ", 
         SuperscriptBox["cP", "2"]}], "-", 
        RowBox[{"2", " ", "\[Mu]"}]}]}]}], "}"}]}], "/.", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"cS", " ", "->", " ", 
      RowBox[{"\[Omega]", "/", "kS"}]}], ",", 
     RowBox[{"cP", " ", "->", " ", 
      RowBox[{"\[Omega]", "/", "kP"}]}]}], "}"}]}], " ", "//", 
  "FullSimplify"}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{{3.8647917700674963`*^9, 3.8647918426961718`*^9}, {
   3.864791968815819*^9, 3.864792027041889*^9}, {3.864792060318007*^9, 
   3.864792060847393*^9}, {3.86479212025788*^9, 3.864792204446488*^9}, 
   3.896842952400343*^9, {3.896842998351715*^9, 3.896842999134282*^9}, {
   3.8968434486073637`*^9, 3.8968434631421633`*^9}, 3.8968435047412453`*^9, {
   3.896843558964736*^9, 3.896843572632375*^9}, 3.896843637252849*^9, {
   3.89684406086014*^9, 3.8968440654437313`*^9}, {3.896844934017168*^9, 
   3.896844934501811*^9}},ExpressionUUID->"039b14f7-53f5-4d23-b0b9-\
6786025efe73"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
  
  RowBox[{
   RowBox[{
    RowBox[{"subN", " ", "=", " ", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"cS", " ", "->", " ", "1.0"}], ",", " ", 
       RowBox[{"cP", " ", "->", " ", "2.0"}], ",", 
       RowBox[{"r1", " ", "->", " ", "0.5"}], ",", 
       RowBox[{"r2", " ", "->", " ", "1.0"}], ",", 
       RowBox[{"\[Rho]", "->", " ", "1.0"}], ",", 
       RowBox[{"\[Omega]", "->", " ", "0.66"}], ",", " ", 
       RowBox[{"n", "->", " ", "0"}], ",", " ", 
       RowBox[{"r", "->", " ", "2.3"}]}], "}"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"subN", " ", "=", 
     RowBox[{"subN", "~", "Join", "~", " ", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{
         RowBox[{"kS", " ", "->", " ", 
          RowBox[{"\[Omega]", "/", "cS"}]}], "/.", "subN"}], ",", 
        RowBox[{
         RowBox[{"kP", " ", "->", " ", 
          RowBox[{"\[Omega]", "/", "cP"}]}], "/.", "subN"}], ",", 
        RowBox[{
         RowBox[{"a", "[", "n", "]"}], "->", 
         RowBox[{"RandomReal", "[", "]"}]}], ",", 
        RowBox[{
         RowBox[{"b", "[", "n", "]"}], "->", 
         RowBox[{"RandomReal", "[", "]"}]}], ",", 
        RowBox[{
         RowBox[{"c", "[", "n", "]"}], "->", 
         RowBox[{"RandomReal", "[", "]"}]}], ",", 
        RowBox[{
         RowBox[{"d", "[", "n", "]"}], "->", 
         RowBox[{"RandomReal", "[", "]"}]}]}], "}"}]}]}], ";"}], 
   "\[IndentingNewLine]", " ", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{
       SuperscriptBox[
        RowBox[{"\[Omega]", " "}], "2"], "\[Rho]", " ", "umodes"}], "//.", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"\[Mu]", " ", "->", " ", 
         RowBox[{"\[Rho]", " ", 
          SuperscriptBox["cS", "2"]}]}], ",", 
        RowBox[{"\[Lambda]", " ", "->", " ", 
         RowBox[{
          RowBox[{"\[Rho]", " ", 
           SuperscriptBox["cP", "2"]}], "-", 
          RowBox[{"2", " ", "\[Mu]"}]}]}]}], "}"}]}], "/.", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"cS", " ", "->", " ", 
        RowBox[{"\[Omega]", "/", "kS"}]}], ",", 
       RowBox[{"cP", " ", "->", " ", 
        RowBox[{"\[Omega]", "/", "kP"}]}]}], "}"}]}], " ", "//.", "subN"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"Divstress", "[", 
       RowBox[{"[", 
        RowBox[{"1", ";;", "2"}], "]"}], "]"}], " ", "//.", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"\[Mu]", " ", "->", " ", 
         RowBox[{"\[Rho]", " ", 
          SuperscriptBox["cS", "2"]}]}], ",", 
        RowBox[{"\[Lambda]", " ", "->", " ", 
         RowBox[{
          RowBox[{"\[Rho]", " ", 
           SuperscriptBox["cP", "2"]}], "-", 
          RowBox[{"2", " ", "\[Mu]"}]}]}]}], "}"}]}], "/.", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"cS", " ", "->", " ", 
        RowBox[{"\[Omega]", "/", "kS"}]}], ",", 
       RowBox[{"cP", " ", "->", " ", 
        RowBox[{"\[Omega]", "/", "kP"}]}]}], "}"}]}], " ", "//.", 
    "subN"}]}]}]], "Input",
 CellChangeTimes->{{3.8647917700674963`*^9, 3.8647918426961718`*^9}, {
   3.864791968815819*^9, 3.864792027041889*^9}, {3.864792060318007*^9, 
   3.864792060847393*^9}, {3.86479212025788*^9, 3.864792204446488*^9}, 
   3.896842952400343*^9, {3.896842998351715*^9, 3.896842999134282*^9}, {
   3.8968434486073637`*^9, 3.8968434631421633`*^9}, 3.8968435047412453`*^9, {
   3.896843558964736*^9, 3.896843572632375*^9}, {3.896843637252849*^9, 
   3.8968436563926897`*^9}, {3.896843737918811*^9, 3.896843832420273*^9}, {
   3.8968438741414337`*^9, 3.896844003932395*^9}, {3.8968440771800203`*^9, 
   3.896844228598755*^9}, {3.896844706893073*^9, 3.896844725849667*^9}, 
   3.896844792322987*^9, 3.89684508703517*^9, 
   3.896845416079299*^9},ExpressionUUID->"ef047db5-5fbc-444d-8a6e-\
af8868e8561e"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{
    RowBox[{"-", "0.03919288996821414`"}], "+", 
    RowBox[{"0.0814021699409822`", " ", "\[ImaginaryI]"}]}], ",", 
   RowBox[{"0.2819382855023038`", "\[VeryThinSpace]", "-", 
    RowBox[{"0.10195006111183186`", " ", "\[ImaginaryI]"}]}]}], 
  "}"}]], "Output",
 CellChangeTimes->{{3.8968447666576366`*^9, 3.8968447932045813`*^9}},
 CellLabel->
  "Out[125]=",ExpressionUUID->"631afd9b-a6b8-4a76-af7c-c35b447909ba"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{
    RowBox[{"-", "0.05783646712676065`"}], "-", 
    RowBox[{"0.004069623670085294`", " ", "\[ImaginaryI]"}]}], ",", 
   RowBox[{
    RowBox[{"-", "0.2035341611682177`"}], "-", 
    RowBox[{"0.051894575976521445`", " ", "\[ImaginaryI]"}]}]}], 
  "}"}]], "Output",
 CellChangeTimes->{{3.8968447666576366`*^9, 3.896844793221735*^9}},
 CellLabel->
  "Out[126]=",ExpressionUUID->"1eeeee1e-3f24-4e21-8468-f6ddbf7a3eae"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      SuperscriptBox[
       RowBox[{"\[Omega]", " "}], "2"], "\[Rho]", " ", 
      RowBox[{"umodes", "/", 
       RowBox[{"Divstress", "[", 
        RowBox[{"[", 
         RowBox[{"1", ";;", "2"}], "]"}], "]"}]}]}], " ", ")"}], "//.", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"\[Mu]", " ", "->", " ", 
       RowBox[{"\[Rho]", " ", 
        SuperscriptBox["cS", "2"]}]}], ",", 
      RowBox[{"\[Lambda]", " ", "->", " ", 
       RowBox[{
        RowBox[{"\[Rho]", " ", 
         SuperscriptBox["cP", "2"]}], "-", 
        RowBox[{"2", " ", "\[Mu]"}]}]}]}], "}"}]}], "/.", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"cS", " ", "->", " ", 
      RowBox[{"\[Omega]", "/", "kS"}]}], ",", 
     RowBox[{"cP", " ", "->", " ", 
      RowBox[{"\[Omega]", "/", "kP"}]}]}], "}"}]}], " ", "//.", 
  "subN"}]], "Input",
 CellChangeTimes->{{3.8647917700674963`*^9, 3.8647918426961718`*^9}, {
   3.864791968815819*^9, 3.864792027041889*^9}, {3.864792060318007*^9, 
   3.864792060847393*^9}, {3.86479212025788*^9, 3.864792204446488*^9}, 
   3.896842952400343*^9, {3.896842998351715*^9, 3.896842999134282*^9}, {
   3.8968434486073637`*^9, 3.8968434631421633`*^9}, 3.8968435047412453`*^9, {
   3.896843558964736*^9, 3.896843572632375*^9}, {3.896843637252849*^9, 
   3.8968436563926897`*^9}, {3.896843737918811*^9, 3.896843832420273*^9}, {
   3.8968438741414337`*^9, 3.896844003932395*^9}, {3.8968440771800203`*^9, 
   3.896844228598755*^9}, {3.896844706893073*^9, 3.896844757570133*^9}},
 CellLabel->
  "In[120]:=",ExpressionUUID->"d1d807fb-024a-4860-8d11-ff1695f95f75"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"0.48582494254920316`", "\[VeryThinSpace]", "-", 
    RowBox[{"1.9824617125769923`", " ", "\[ImaginaryI]"}]}], ",", 
   RowBox[{
    RowBox[{"-", "1.3682426375573584`"}], "+", 
    RowBox[{"0.23782523609131387`", " ", "\[ImaginaryI]"}]}]}], 
  "}"}]], "Output",
 CellChangeTimes->{{3.896844743375044*^9, 3.896844768773698*^9}},
 CellLabel->
  "Out[120]=",ExpressionUUID->"f598c3ba-bbc7-4d92-b9d7-a80241129417"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", 
  RowBox[{"RandomReal", "[", "]"}]}]], "Input",
 CellChangeTimes->{{3.896844195601273*^9, 3.896844196059609*^9}},
 CellLabel->"In[88]:=",ExpressionUUID->"c233d3a3-5550-4720-82bd-395be2ba1edb"],

Cell[BoxData["0.8709546675108832`"], "Output",
 CellChangeTimes->{
  3.8647922174888363`*^9, 3.864797216645588*^9, 3.8968429994059353`*^9, 
   3.896843575314363*^9, {3.896843642179185*^9, 3.8968436575420237`*^9}, 
   3.896843774183795*^9, {3.89684380422545*^9, 3.896843833139659*^9}, 
   3.896843874827417*^9, {3.8968439140416937`*^9, 3.89684398198354*^9}, 
   3.896844093205266*^9, {3.896844147384261*^9, 3.8968441626239767`*^9}, 
   3.8968441964585943`*^9},
 CellLabel->"Out[88]=",ExpressionUUID->"8b2c16ae-3bf5-42bc-906e-b3125e4b6b01"]
}, Open  ]]
}, Open  ]]
},
WindowSize->{1440, 762},
WindowMargins->{{0, Automatic}, {0, Automatic}},
Magnification:>1.25 Inherited,
FrontEndVersion->"13.0 for Linux x86 (64-bit) (December 2, 2021)",
StyleDefinitions->"Default.nb",
ExpressionUUID->"26a89f0b-cf74-4caf-bf39-abc104f75f33"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[558, 20, 686, 11, 101, "Text",ExpressionUUID->"f31cd68b-6497-479b-9447-378ff3fbc61e"],
Cell[1247, 33, 579, 11, 46, "Input",ExpressionUUID->"15c1fbda-52fd-48d7-aca8-7ad7a02596e6"],
Cell[CellGroupData[{
Cell[1851, 48, 5551, 148, 670, "Input",ExpressionUUID->"ce7f7aba-66b9-40e6-b7d8-56410ec58cd0"],
Cell[7405, 198, 2424, 67, 128, "Output",ExpressionUUID->"7bd9dcb8-d1c2-4fdd-bd4f-e416e226841f"],
Cell[9832, 267, 2349, 64, 63, "Output",ExpressionUUID->"2a46dad3-bf39-4863-b71d-d6c78afb7645"]
}, Open  ]],
Cell[CellGroupData[{
Cell[12218, 336, 7584, 209, 491, "Input",ExpressionUUID->"0e7409ac-b54a-489c-9b37-50416ead2a46"],
Cell[19805, 547, 1196, 18, 41, "Output",ExpressionUUID->"36b8d6d9-8810-4cdb-8416-9a0cbc23a506"]
}, Open  ]],
Cell[CellGroupData[{
Cell[21038, 570, 220, 5, 68, "Subsection",ExpressionUUID->"1ebfa159-742b-4f31-8848-2d86db2e38d0"],
Cell[CellGroupData[{
Cell[21283, 579, 5108, 142, 596, "Input",ExpressionUUID->"ac31c522-5dee-4b23-a408-4436b8aa72b1"],
Cell[26394, 723, 559, 8, 41, "Output",ExpressionUUID->"5cc1dc10-c401-426b-b3ee-dcaf4f1bc399"],
Cell[26956, 733, 559, 8, 41, "Output",ExpressionUUID->"6fb2d1e7-8f10-48b0-b5d0-e23254e2b329"],
Cell[27518, 743, 3060, 80, 113, "Output",ExpressionUUID->"049649b8-8b0b-499a-8354-85657f9cb8f5"],
Cell[30581, 825, 1934, 51, 101, "Output",ExpressionUUID->"d81d9611-d1b3-4c42-b028-0716fec7655b"],
Cell[32518, 878, 3007, 79, 113, "Output",ExpressionUUID->"7d71cda3-b35f-4c8f-a2b9-b2de3e08edc9"],
Cell[35528, 959, 1957, 52, 101, "Output",ExpressionUUID->"74b44ed6-9ed5-48be-aff7-3928a0fb04ce"]
}, Open  ]],
Cell[37500, 1014, 1884, 51, 116, "Input",ExpressionUUID->"d7be7fae-e9d6-4287-b40c-f2849ad0ba97"],
Cell[CellGroupData[{
Cell[39409, 1069, 4567, 125, 427, "Input",ExpressionUUID->"b1185457-102d-43d7-9ae5-f802715e4896"],
Cell[43979, 1196, 158, 3, 41, "Output",ExpressionUUID->"59cf3834-3a0f-401e-acd0-41d1516174ba"],
Cell[44140, 1201, 1487, 46, 44, "Output",ExpressionUUID->"da2b4b9e-89a3-4ea1-9506-b72028ff6e4b"],
Cell[45630, 1249, 1469, 45, 44, "Output",ExpressionUUID->"4576805d-581e-4ccd-88ba-f840a9162dad"],
Cell[47102, 1296, 158, 3, 41, "Output",ExpressionUUID->"cd7263f0-af74-4666-a7ce-fbecde7a2fc8"],
Cell[47263, 1301, 726, 23, 58, "Output",ExpressionUUID->"a75647d2-2505-40b6-9043-7b8c243d35ac"],
Cell[47992, 1326, 747, 24, 58, "Output",ExpressionUUID->"0d3b6458-49fb-4b7f-bb4a-b2c3793c29e8"]
}, Open  ]],
Cell[CellGroupData[{
Cell[48776, 1355, 3803, 84, 348, "Input",ExpressionUUID->"387c52ca-2a41-4ddf-a45c-cc425a515f0a"],
Cell[52582, 1441, 205, 3, 41, "Output",ExpressionUUID->"8948a7bf-9917-44b3-9b1b-0533f06883ba"]
}, Open  ]],
Cell[CellGroupData[{
Cell[52824, 1449, 3070, 78, 265, "Input",ExpressionUUID->"e348ad66-6610-49f7-ac8c-1120c0dd718d"],
Cell[55897, 1529, 291, 4, 41, "Output",ExpressionUUID->"7bffe31b-8708-481b-82c4-d35b7686e1ab"]
}, Open  ]],
Cell[CellGroupData[{
Cell[56225, 1538, 2315, 62, 265, "Input",ExpressionUUID->"86804f68-5199-4c83-8410-d9a6a2321448"],
Cell[58543, 1602, 7506, 138, 289, "Output",ExpressionUUID->"80f3c367-0ce7-4d76-93aa-88c2e42574f3"]
}, Open  ]],
Cell[66064, 1743, 355, 7, 46, "Input",ExpressionUUID->"c08a5ac0-875f-470c-832c-c6ccd0f14aea"],
Cell[CellGroupData[{
Cell[66444, 1754, 1657, 34, 88, "Input",ExpressionUUID->"aa78a95b-2905-4bcd-8c0d-cc3dc8fb9fdc"],
Cell[68104, 1790, 151, 2, 41, "Output",ExpressionUUID->"7402f355-7d3f-4d13-8d88-2df342293216"]
}, Open  ]],
Cell[68270, 1795, 4352, 113, 245, "Input",ExpressionUUID->"762154bb-a303-4485-8d10-96930f4ffeb2"],
Cell[72625, 1910, 1736, 33, 39, "Input",ExpressionUUID->"7c9e1b0d-ffeb-4c4b-a400-eed0f72d870f"],
Cell[74364, 1945, 705, 22, 61, InheritFromParent,ExpressionUUID->"d3b5a10a-1df7-4e5c-a6dd-75777c1d6255"],
Cell[CellGroupData[{
Cell[75094, 1971, 3978, 94, 242, "Input",ExpressionUUID->"3ca3453f-87de-41db-8e1c-569768423cbc"],
Cell[79075, 2067, 3996, 115, 154, "Output",ExpressionUUID->"0d623c6b-3e02-4cf9-9a6d-d5151f854ce1"],
Cell[83074, 2184, 180, 2, 41, "Output",ExpressionUUID->"70e50812-ca73-4329-b59c-f93ef0164b81"]
}, Open  ]],
Cell[CellGroupData[{
Cell[83291, 2191, 1426, 22, 36, "Input",ExpressionUUID->"0b405d52-8534-419e-9869-23d09233aa2a"],
Cell[84720, 2215, 3165, 86, 113, "Output",ExpressionUUID->"eae76e7a-31be-4d0e-b40e-94a67cab522a"]
}, Open  ]],
Cell[CellGroupData[{
Cell[87922, 2306, 911, 25, 88, "Input",ExpressionUUID->"5a108c5f-0b6a-415e-8f34-9c938f064cd2"],
Cell[88836, 2333, 2362, 74, 60, "Output",ExpressionUUID->"58c23918-9121-4e8d-941c-dcca93cb19e9"],
Cell[91201, 2409, 969, 27, 60, "Output",ExpressionUUID->"77a45012-2fc1-4421-9ed9-b365f3e13f0f"]
}, Open  ]],
Cell[CellGroupData[{
Cell[92207, 2441, 1239, 25, 36, "Input",ExpressionUUID->"61348b7a-d01d-423b-92d6-650be2ea8c76"],
Cell[93449, 2468, 682, 13, 35, "Message",ExpressionUUID->"b8ae6de7-6be0-479c-bce2-ee93bc49419c"],
Cell[94134, 2483, 662, 17, 41, "Output",ExpressionUUID->"4a823541-6d3e-44fe-b295-d5512529414f"]
}, Open  ]],
Cell[94811, 2503, 2357, 62, 191, "Input",ExpressionUUID->"039b14f7-53f5-4d23-b0b9-6786025efe73"],
Cell[CellGroupData[{
Cell[97193, 2569, 3864, 98, 219, "Input",ExpressionUUID->"ef047db5-5fbc-444d-8a6e-af8868e8561e"],
Cell[101060, 2669, 465, 11, 59, "Output",ExpressionUUID->"631afd9b-a6b8-4a76-af7c-c35b447909ba"],
Cell[101528, 2682, 466, 12, 59, "Output",ExpressionUUID->"1eeeee1e-3f24-4e21-8468-f6ddbf7a3eae"]
}, Open  ]],
Cell[CellGroupData[{
Cell[102031, 2699, 1640, 39, 39, "Input",ExpressionUUID->"d1d807fb-024a-4860-8d11-ff1695f95f75"],
Cell[103674, 2740, 461, 11, 59, "Output",ExpressionUUID->"f598c3ba-bbc7-4d92-b9d7-a80241129417"]
}, Open  ]],
Cell[CellGroupData[{
Cell[104172, 2756, 239, 4, 62, "Input",ExpressionUUID->"c233d3a3-5550-4720-82bd-395be2ba1edb"],
Cell[104414, 2762, 538, 8, 41, "Output",ExpressionUUID->"8b2c16ae-3bf5-42bc-906e-b3125e4b6b01"]
}, Open  ]]
}, Open  ]]
}
]
*)

